"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3322],{89410:(e,t,n)=>{n.d(t,{n:()=>r});var a=n(61e3),i=n(89913),s=n(86070);const r=({icon:e,activeIcon:t,label:n,isActive:r,...o})=>(0,s.jsx)(i.Zp,{label:n,children:(0,s.jsx)(a.H,{"aria-label":`${n}, ${r?"selected":"unselected"}, button`,"aria-pressed":r,semanticColor:r?"textBrightAccent":"textSubdued",iconOnly:r?t:e,"aria-haspopup":"menu",size:"small",...o})})},43904:(e,t,n)=>{n.d(t,{J:()=>d});var a=n(97500),i=n.n(a),s=n(49730),r=n(13505),o=n(93492);const c={wrapper:"Z1zuyPu02pMVCOAyEnFO"};var l=n(86070);function d(){return(0,l.jsx)("div",{className:i()("encore-dark-theme",c.wrapper),children:(0,l.jsx)(s.v,{children:(0,l.jsx)(r.E,{variant:"marginalBold",children:o.Ru.get("ad-formats.ad-feedback.beta-tag")})})})}},7340:(e,t,n)=>{n.d(t,{t:()=>x});var a=n(62411),i=n(40565),s=n(74455),r=n(93492),o=n(89410),c=n(90323),l=n(45649),d=n(13087),u=n(60410),m=n(585),g=n(30758),p=n(43904),v=n(55669),h=n(56695),y=n(24395),b=n(86070);const f=(0,g.memo)((function({onFeedbackReasonSelect:e}){const t=new Map([["not_relevant",r.Ru.get("ad-formats.ad-feedback.dislike.not-relevant")],["too_often",r.Ru.get("ad-formats.ad-feedback.dislike.too-often")],["unpleasant",r.Ru.get("ad-formats.ad-feedback.dislike.unpleasant-content")],["offensive",r.Ru.get("ad-formats.ad-feedback.dislike.offensive-content")],["do_not_like",r.Ru.get("ad-formats.ad-feedback.dislike.do-not-like")]]);return(0,b.jsx)(y.pZ,{value:"dislike-ad",children:(0,b.jsxs)(v.W,{children:[(0,b.jsx)(p.J,{}),Array.from(t).map((([t,n])=>(0,b.jsx)(y.pZ,{value:n,children:(0,b.jsx)(h.D,{role:"menuitem","aria-label":n,onClick:()=>e(t,n),children:n})},t)))]})})})),x=({item:e,isDisabled:t})=>{const n=(0,a.wA)(),{logAdFeedback:g}=(0,l.L)(e),p=(0,a.d4)((t=>(0,u.N)(t,e.id))),v=(0,c.d)();return(0,b.jsx)(m.b,{menu:(0,b.jsx)(f,{onFeedbackReasonSelect:(t,a)=>{e.id&&(n((0,d.NI)({adId:e.id,reason:a})),g(`dislike_${t}`),v({message:r.Ru.get("ad-formats.ad-feedback.thanks-for-feedback")}))}}),children:(0,b.jsx)(o.n,{item:e,icon:i.P,activeIcon:s.X,label:r.Ru.get("ad-formats.ad-feedback.dislike"),isActive:p,"data-testid":"button-dislike-ad",onClick:()=>{if(e.id){if(p)return n((0,d.vA)({adId:e.id})),void g("cancel_dislike");n((0,d.NI)({adId:e.id})),g("dislike_menu")}},disabled:t})})}},82371:(e,t,n)=>{n.d(t,{T:()=>x});var a=n(62411),i=n(44158),s=n(48776),r=n(93492),o=n(89410),c=n(90323),l=n(45649),d=n(13087),u=n(60410),m=n(585),g=n(30758),p=n(43904),v=n(55669),h=n(56695),y=n(24395),b=n(86070);const f=(0,g.memo)((function({onFeedbackReasonSelect:e}){const t=new Map([["relevant",r.Ru.get("ad-formats.ad-feedback.like.relevant")],["interested_in_brand",r.Ru.get("ad-formats.ad-feedback.like.interested-in-brand")],["interested_in_product",r.Ru.get("ad-formats.ad-feedback.like.interested-in-product")],["enjoyable",r.Ru.get("ad-formats.ad-feedback.like.enjoyable-content")],["discovered_new",r.Ru.get("ad-formats.ad-feedback.like.discovered-new")]]);return(0,b.jsx)(y.pZ,{value:"like-ad",children:(0,b.jsxs)(v.W,{children:[(0,b.jsx)(p.J,{}),Array.from(t).map((([t,n])=>(0,b.jsx)(y.pZ,{value:n,children:(0,b.jsx)(h.D,{role:"menuitem","aria-label":n,onClick:()=>e(t,n),children:n})},t)))]})})})),x=({item:e,isDisabled:t})=>{const n=(0,a.wA)(),{logAdFeedback:g}=(0,l.L)(e),p=(0,a.d4)((t=>(0,u.T)(t,e.id))),v=(0,c.d)();return(0,b.jsx)(m.b,{menu:(0,b.jsx)(f,{onFeedbackReasonSelect:(t,a)=>{e.id&&(n((0,d.F$)({adId:e.id,reason:a})),g(`like_${t}`),v({message:r.Ru.get("ad-formats.ad-feedback.thanks-for-feedback")}))}}),children:(0,b.jsx)(o.n,{item:e,icon:i.G,activeIcon:s.q,label:r.Ru.get("ad-formats.ad-feedback.like"),isActive:p,"data-testid":"button-like-ad",onClick:()=>{if(e.id){if(p)return n((0,d.D$)({adId:e.id})),void g("cancel_like");n((0,d.F$)({adId:e.id})),g("like_menu")}},disabled:t})})}},90323:(e,t,n)=>{n.d(t,{d:()=>m});var a=n(30758),i=n(97500),s=n.n(i),r=n(50154),o=n(13505),c=n(43904),l=n(63522);const d={background:"_zvku8iAETpqf0BS7mYj"};var u=n(86070);function m(){const{enqueueCustomSnackbar:e}=(0,l.i)();return(0,a.useCallback)((({message:t})=>{e((0,u.jsxs)(r.a,{variant:"elevated",className:s()("encore-light-theme","encore-layout-themes",d.background),children:[(0,u.jsx)(o.E,{variant:"bodyMedium",children:t}),(0,u.jsx)(c.J,{})]}),{identifier:t})}),[e])}},2755:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(30758),i=n(97500),s=n.n(i),r=n(72574),o=n(91984),c=n(86070);const l="div";class d extends a.Component{constructor(e){super(e),this.state={isDropTargetActive:!1},this.enterEventCount=0,this.leaveEventCount=0}componentDidMount(){document.body.addEventListener("dragend",this.handleDragEnd)}shouldComponentUpdate(e,t){return t.isDropTargetActive!==this.state.isDropTargetActive||e.children!==this.props.children||e.onDragEnter!==this.props.onDragEnter||e.onDragLeave!==this.props.onDragLeave||e.onDrop!==this.props.onDrop||e.types.length!==this.props.types.length||e.types.some(((e,t)=>e!==this.props.types[t]))}componentWillUnmount(){document.body.removeEventListener("dragend",this.handleDragEnd)}handleDragOver=e=>{this.getMatchingMimeTypes(e).length>0&&(e.preventDefault(),e.dataTransfer.dropEffect="copy")};handleDragEnter=e=>{this.enterEventCount&&!e.relatedTarget||(this.enterEventCount++,1===this.enterEventCount&&this.getMatchingMimeTypes(e).length>0&&(this.props.onDragEnter?.(e),this.setState({isDropTargetActive:!0})))};handleDragLeave=e=>{this.leaveEventCount++,this.leaveEventCount===this.enterEventCount&&this.getMatchingMimeTypes(e).length>0&&(this.enterEventCount=0,this.leaveEventCount=0,this.props.onDragLeave?.(e),this.setState({isDropTargetActive:!1}))};handleDragEnd=()=>{this.enterEventCount=0,this.leaveEventCount=0};handleDrop=e=>{if(0===this.getMatchingMimeTypes(e).length)return;const{onDragLeave:t,onDrop:n}=this.props,a=this.getMatchingDropData(e);this.enterEventCount=0,this.leaveEventCount=0;const i=e.defaultPrevented;e.preventDefault(),t?.(e),i||n(e,a),this.setState({isDropTargetActive:!1})};getMatchingMimeTypes(e){const t=this.props.types;return Array.from(e.dataTransfer.types).filter((e=>t.includes(e)))}getMatchingDropData(e){const t=this.getMatchingMimeTypes(e),n={};t.forEach((t=>{const a=e.dataTransfer.getData(t),i=0===t.indexOf("text/x-spotify"),s=i?a.split("\n"):[a];n[t]=s.map((e=>{if(i){const t=(0,r.o_h)(e);if(t)return t.toURI()}return e})).filter((e=>!!e))}));const a=e.dataTransfer.getData("text/plain");return n.all=a?a.split("\n").map((e=>{const t=(0,r.o_h)(e);return t?t.toURI():e})):[],n}render(){const{types:e=[],as:t=l,testId:n,className:a=""}=this.props,i=t,r=e.filter(Boolean).map((e=>`GlueDropTarget--${e.replace("text/x-spotify-","")}`));return(0,c.jsx)(i,{className:s()("GlueDropTarget",r,{"GlueDropTarget--active":this.state.isDropTargetActive},a),onDragOver:this.handleDragOver,onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop,onContextMenu:this.props.onContextMenu,"data-testid":n,children:this.props.children})}}const u=e=>{const{supportsDragAndDrop:t}=(0,o._)();if(!t){const t=e.as??l;return(0,c.jsx)(t,{children:e.children})}return(0,c.jsx)(d,{...e})}},63743:(e,t,n)=>{n.d(t,{f:()=>m});var a=n(30758),i=n(97500),s=n.n(i),r=n(61e3),o=n(89913);const c="KAZD28usA1vPz5GVpm63",l="RK45o6dbvO1mb0wQtSwq",d="EHxL6K_6WWDlTCZP6x5w";var u=n(86070);const m=(0,a.forwardRef)(((e,t)=>{const n=e.isActive??!1,a=s()(c,{[l]:n||e.isActiveNoIndicator,[d]:n},e.className);return(0,u.jsx)(o.Zp,{label:e.label,children:(0,u.jsx)(r.H,{ref:t,style:e.style,"aria-label":e.label,size:"small",className:a,disabled:e.disabled,iconOnly:e.icon,onClick:e.onToggle,"data-testid":e.testId,"data-active":n.toString(),"aria-pressed":n,"data-restore-focus-key":e.restoreFocusKey})})}))},46952:(e,t,n)=>{n.d(t,{NowPlayingBar:()=>Ai});var a=n(30758),i=n(97500),s=n.n(i),r=n(62411),o=n(94079),c=n(85074),l=n(13505),d=n(555),u=n(93492);const m="dz_h98rH9nZCwfPdnKgr",g="rAfV2jB_HMM9Xtr0Rqvn",p="XkXPpDRWozMF6G8_GlLQ";var v=n(86070);const h=a.memo((function(e){const{handleClick:t}=e,n=u.Ru.get("pta.bottom-bar.title"),a=u.Ru.get("fta.bottom-bar.subtitle"),i=u.Ru.get("fta.sign-up-free");return(0,v.jsxs)("div",{className:m,onClick:t,"data-testid":"signup-bar",children:[(0,v.jsxs)("div",{className:g,children:[(0,v.jsx)(l.E,{as:"p",variant:"bodySmallBold",children:n}),(0,v.jsx)(l.E,{as:"p",variant:"bodyMedium",dangerouslySetInnerHTML:{__html:a}})]}),(0,v.jsx)(d.$,{colorSet:"invertedLight",onClick:t,className:p,children:i})]})}));var y=n(6154),b=n(74905),f=n(12495),x=n(88599),k=n(45924),C=n(28518),N=n(73097),S=n(82362);const j="gqYYMz8DkhaT3e44LcHQ",I="VX33mI2V_jRA7hRBI9_0",w=({remoteDeviceName:e,remoteDeviceType:t,connectionStatus:n,omitConnectionStateText:a=!1})=>{const{spec:i,logger:s}=(0,S.r)(f.s,{}),{triggerRef:r,toggleDevicePicker:o,isPickerOpen:c}=(0,k.z)(),d=(0,C.$A)(t,n),m=n===N.zP.CONNECTED?u.Ru.get("web-player.connect.bar.connected-state",{device_name:e}):u.Ru.get("web-player.connect.bar.connecting-state",{device_name:e});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(d,{size:"small",className:I,role:"presentation",semanticColor:"essentialBase"}),(0,v.jsx)(b.Y,{component:"button",onClick:()=>{const e=i.activeDeviceButtonFactory(),{interactionId:t}=s.logInteraction(c?e.hitUiHide():e.hitUiReveal()),n=c;o(t),n||(0,x.I)("DEVICE-PICKER")},ref:r,className:j,children:(0,v.jsx)(l.E,{variant:"bodySmallBold","aria-live":"polite",semanticColor:"textBase",children:a&&n===N.zP.CONNECTED?e:m})})]})},A="nQSM_BrSHJ4Cp3XSuLOF",D=()=>(0,v.jsxs)("svg",{width:"1",height:"16",viewBox:"0 0 1 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"separator",className:A,children:[(0,v.jsx)("g",{id:"separator",clipPath:"url(#clip0_491_88335)",children:(0,v.jsx)("rect",{id:"Rectangle 111112858",width:"1",height:"16",rx:"0.5",fill:"var(--essential-base)"})}),(0,v.jsx)("defs",{children:(0,v.jsx)("clipPath",{id:"clip0_491_88335",children:(0,v.jsx)("rect",{width:"1",height:"16",fill:"white"})})})]});var T=n(71627),E=n(98538),R=n(57724),L=n(94822),P=n(58225);const B="gQoa8JTSpjSmYyABcag2",_="T3hkVxXuSbCYOD2GIeQd",O="GcHojieewpdN1c8vbtwk",F=function(){const{isPlayingRemotely:e,connectionStatus:t,remoteDeviceName:n,remoteDeviceType:a}=(0,R.v)((e=>{const t=(0,E.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,connectionStatus:t.connectionStatus,remoteDeviceName:t.remoteDevice?.name,remoteDeviceType:t.remoteDevice?.type}}),P.a),{currentSession:i}=(0,L.D)(),r=Boolean(i?.active),o=e&&n&&a;if(!o&&!r)return null;const c=t===N.zP.CONNECTED||r,l=t===N.zP.CONNECTING&&!r;return(0,v.jsxs)("div",{className:s()(B,{"encore-bright-accent-set":c,[_]:c,[O]:l}),children:[r&&(0,v.jsx)(T.K,{}),r&&o&&(0,v.jsx)(D,{}),o&&(0,v.jsx)(w,{connectionStatus:t,remoteDeviceName:n,remoteDeviceType:a,omitConnectionStateText:r})]})},M=()=>(0,v.jsx)(a.Suspense,{fallback:null,children:(0,v.jsx)(F,{})});var U=n(40638),z=n(3118),V=n(34433),G=n(24409),Q=n(12032),q=n(73120),K=n(80478),H=n(63743),Z=n(95008),Y=n(34668);const W=({className:e="",disabledClassName:t="",onClick:n})=>{const i=(0,K.lZ)(),o=(0,a.useContext)(q.s),c=(0,Y.o)((e=>e?.hasContext??!1)),l=(0,r.wA)(),d=!c,m=(0,a.useCallback)((async()=>{o?.current&&(n?.(!0),l((0,Q.f)()),(0,Z.X8)(o.current))}),[l,o,n]),g=s()(e,{[t]:d});return i?(0,v.jsx)(H.f,{onToggle:m,className:g,icon:G.L,label:u.Ru.get("npv.full-screen"),disabled:d,testId:"fullscreen-mode-button"}):null},X=(0,a.memo)(W);var J=n(25265),$=n(51278),ee=n(94898);var te=n(61565),ne=n(61e3),ae=n(27508);const ie="xP7v0EBcbJMj1xIJxywg",se="zJU_lLLzQL6oKvMA0c5b",re=({onClose:e,onMouseEnter:t,onMouseLeave:n,onClick:a,impressionCallback:i,message:s})=>(0,v.jsxs)("div",{className:ie,onMouseEnter:t,onMouseLeave:n,ref:i,onClick:a,children:[(0,v.jsx)(l.E,{id:"nudgeBody",as:"p",variant:"bodyMedium",semanticColor:"textBase",children:s}),(0,v.jsx)(ne.H,{iconOnly:ae.M,size:"small",semanticColor:"textBase",onClick:t=>{t.stopPropagation(),e?.()},"aria-label":u.Ru.get("close"),className:se})]});var oe=n(20697),ce=n(34244);const le=(e=oe.C)=>{const t=(0,r.Pj)(),{isActive:n}=e(),a=(0,ce.h)();return document.hasFocus()&&!n&&!(({ui:e,ads:t},n)=>e.blockUserDialog.isOpen||e.connectDevicePicker.isOpen||e.deleteFolderDialog.isOpen||e.deletePlaylistDialog.isOpen||e.fullscreenMode.isOpen||e.improvedSignupPromptDialog.isOpen||e.keyboardShortcutsHelpModal.isOpen||e.leavePlaylistDialog.isOpen||e.loginToListenDialog.isOpen||e.offlineDeviceLimitReachedDialog.isOpen||e.playbackNotSupportedErrorDialog.isOpen||e.premiumDialog.isOpen||e.signupToListenDialog.isOpen||!0===t.billboard?.isOpen&&!t.billboard.isMinimized||!1===t.vto?.isHidden&&!1===t.vto?.isMinimized||n)(t.getState(),a.current.length>0)};var de=n(17387);var ue=n(4827),me=n(63440),ge=n(27561),pe=n(75843),ve=n(64273),he=n(78233),ye=n(4270),be=n(34756);const fe=e=>{const t=(0,a.useRef)(),n=(0,a.useRef)(),i=(0,a.useRef)(!1),s=(0,ve.z)(),r=(0,me.Z)(),{spec:o,logger:c}=(0,S.r)(de.w,{}),l=(0,a.useRef)(null),d=(0,a.useCallback)((()=>{c.logInteraction(o.djVoiceUnsupportedNudgeFactory().closeButtonFactory().hitUiHide())}),[o,c]),m=(0,a.useCallback)((e=>{e&&l.current!==e&&c.logImpression(o.djVoiceUnsupportedNudgeFactory().impression()),l.current=e}),[o,c]),g=(0,a.useCallback)((()=>{const e=s.getState(),t=r.getActiveDevice();return!(e=>e?.isLocal??!1)(t)&&(0,be.yc)(e,"spotify:playlist:37i9dQZF1EYkqdzj48dyYq")!==ye.i.NOT_ACTIVE&&!(e=>Boolean(e?.supportsDJNarration))(t??void 0)}),[s,r]),p=(0,a.useCallback)((()=>{g()&&e({nudgeType:"message-only-nudge",message:u.Ru.get("web-player.connect.nudge.dj-voice-unavailable"),onClose:d,impressionCallback:m})}),[e,g,d,m]),v=(0,a.useCallback)((e=>{e.data.action===pe.Ik.PLAY&&(i.current=!0)}),[]);(0,he.p)(pe.gd.ACTION,v);const h=(0,a.useCallback)((e=>{i.current&&(0,be.uW)(e.data)===ye.i.PLAYING&&(t.current=e.data?.context.uri,p(),t.current=void 0,i.current=!1)}),[p]);(0,he.p)(pe.gd.UPDATE,h);const y=(0,a.useCallback)((e=>{const t=e.data?.activeDevice;t&&!t.isLocal&&n.current!==t.connectStateId&&p(),n.current=t?.connectStateId}),[p]);(0,ge.W)(ue.P.UPDATE,y)};var xe=n(13982);const ke=e=>{switch(e.type){case N.bq.AUDIO_DONGLE:case N.bq.AVR:case N.bq.CAST_AUDIO:case N.bq.CAST_VIDEO:case N.bq.GAME_CONSOLE:case N.bq.SPEAKER:case N.bq.STB:case N.bq.TV:return!0;default:return!1}};var Ce=n(17013),Ne=n(87578),Se=n(72288);const je=new Date(0).toISOString(),Ie=["shift+alt+f10"],we=e=>{const t=(0,a.useRef)(),n=(0,a.useRef)(!1),i=(0,a.useRef)(!1),s=(0,r.Pj)(),o=(0,ve.z)(),c=(0,me.Z)(),l=(0,Ne.V)(),[d,m]=(0,Se.x)("connect-nudge-triggered-at",je),g=(0,a.useRef)(null),{spec:p,logger:v}=(0,S.r)(de.w,{}),h=(0,a.useCallback)((()=>{v.logInteraction(p.connectFromDevicePickerNudgeFactory().hitNoAction())}),[p,v]),y=(0,a.useCallback)((()=>{v.logInteraction(p.connectFromDevicePickerNudgeFactory().closeButtonFactory().hitUiHide())}),[p,v]),b=(0,a.useCallback)((e=>{e&&g.current!==e&&v.logImpression(p.connectFromDevicePickerNudgeFactory().impression()),g.current=e}),[p,v]);(0,Ce.f)(Ie,(async()=>{const{platform:{isDeveloperMode:e}}=s.getState();if(e){const e=new Date;e.setHours(e.getHours()-8),m(e.toISOString())}}));const f=(0,a.useCallback)((()=>{const e=o.getState(),t=c.getActiveDevice(),n=c.getDevices(),a=l.getDefaultDevice(),i=new Date(d);i.setHours(i.getHours()+8);return i<=new Date&&(e=>e?.isLocal??!1)(t)&&!(0,be.A3)(e)&&(e=>e.some((e=>e.isLocalNetwork&&!e.isDisabled&&ke(e))))(n)&&(e=>!e||!(e.terminalType===xe.FI.HEADPHONES||e.terminalType===xe.FI.SPEAKERS&&(e.transportType===xe.Yg.BLUETOOTH||e.transportType===xe.Yg.USB)))(a)}),[o,l,d,c]),x=(0,a.useCallback)((()=>{if(f()){e({nudgeType:"message-only-nudge",message:u.Ru.get("web-player.connect.nudge.listen-to-speaker"),impressionCallback:b,onClick:h,onClose:y});const t=(new Date).toISOString();m(t)}}),[e,f,m,h,y,b]),k=(0,a.useCallback)((e=>{e.data.action===pe.Ik.PLAY?n.current=!0:e.data.action===pe.Ik.RESUME&&(i.current=!0)}),[]);(0,he.p)(pe.gd.ACTION,k);const C=(0,a.useCallback)((e=>{n.current&&(0,be.uW)(e.data)===ye.i.PLAYING?(t.current=e.data?.context.uri,x(),t.current=void 0,n.current=!1):i.current&&!1===e.data?.isPaused&&(t.current=e.data?.context.uri,x(),t.current=void 0,i.current=!1)}),[x]);(0,he.p)(pe.gd.UPDATE,C)};var Ae=n(44319),De=n(72574),Te=n(26906),Ee=n(55848),Re=n(91327),Le=n(75788),Pe=n(61943),Be=n(45675),_e=n(81435);const Oe=e=>{const t=(0,Le.d)(),{getSessionInfo:n,joinSession:i,currentSession:s}=(0,L.D)(),r=(0,Te.vh)(),o=(0,Ee.b)(),c=(0,xe.lS)(o),l=(0,a.useRef)(new Set),d=(0,a.useCallback)((async(e,t,n)=>{l.current.add(t);const a="IN_PERSON",s=Be.JO.NEARBY_DIALOG;try{const o=await i(e,s,a);o&&r.send((0,Ae.X)({session_id:t,join_type:s,join_url:o.joinSessionUri,participation_mode:a,discovery_methods:[n]}))}catch(e){e instanceof Error&&r.send((0,Ae.X)({session_id:t,error_category:e.name,error_data:e.message,discovery_methods:[n]}))}}),[r,i]),m=(0,ve.z)(),g=(0,a.useCallback)((()=>(0,be.uW)(m.getState())!==ye.i.PLAYING),[m]),p=(0,a.useCallback)((async(t,{sessionMembers:n,sessionOwnerId:a,sessionId:i,isSessionOwner:s})=>{const r=n.find((e=>e.id===a));if(!r||s)return;const o=n.map((e=>({uri:(0,De.Qjr)(e.username).toURI(),displayName:e.displayName,username:e.username,images:e.imageUrl?[{url:e.imageUrl}]:[]})));if(g()){const n=t.tech===_e.x.BLUETOOTH?"bluetooth":"broadcast";e({nudgeType:"join-listening-session-nudge",title:u.Ru.get("web-player.social-connect.broadcasting.join-listening-session-nudge-title",{host:r.displayName,device:t.title}),message:u.Ru.get("web-player.social-connect.broadcasting.join-listening-session-nudge-text"),onClose:()=>{},onActionButtonClick:()=>{d(t.token,i,n)},users:o,discoveryMethod:n})}}),[g,d,e]);(0,Pe.c)(Re.P.SCAN_UPDATE,(()=>{if(s?.active)return;const e=t.getLocalNetSessionDevices(),a=e?.devices.find((e=>e.isNew));a&&(async e=>{if(c)return;const a=await n(e.token);if(a){if(l.current.has(a.sessionId))return;const n=await t.getLocalNetSesssionDeviceVisibility(a.sessionId);n!==Be.MS.UNSPECIFIED&&n!==Be.MS.NOTIFY||p(e,a)}})(a)}))};var Fe=n(21832),Me=n(14109),Ue=n(75097),ze=n(86350);const Ve=e=>{we(e),fe(e),Oe(e),(e=>{const{panelSend:t}=(0,Fe.AI)(Ue.Z.DevicePicker,Ue.Z.DevicePickerOverlay),[n,i]=(0,Se.x)("session-broadcast-nudge-shown",[]),s=(0,a.useCallback)((e=>{const t=[...n,e];t.length>10&&t.shift(),i(t)}),[n,i]);(0,Pe.c)(Re.P.BROADCAST_NUDGE,(({data:a})=>{const i=a.deviceId;a.broadcastStatus===ze.ez.BROADCAST_ON&&i&&!n.includes(i)&&e({nudgeType:"session-is-being-broadcasted-nudge",message:u.Ru.get("web-player.social-connect.broadcasting.session-is-being-broadcasted-nudge-text"),onClose:()=>{},onActionButtonClick:()=>{t({type:Me.$S.DEVICE_PICKER_BUTTON_CLICK})},onShow:()=>{s(i)}})}))})(e)},Ge=()=>{const e=(0,a.useRef)(),t=(0,a.useRef)(!1),n=(0,a.useRef)(!1),i=(0,r.wA)(),s=(0,r.d4)((e=>e.ui.connectNudge.isOpen)),o=(0,r.d4)((e=>e.ui.connectDevicePicker.isOpen)),c=(0,a.useCallback)((()=>{n.current&&(clearTimeout(e.current),n.current=!1),i((0,Q.Yp)())}),[i]),l=(0,a.useCallback)((()=>{n.current=!1,t.current||c()}),[c]),d=(0,a.useCallback)((()=>{e.current=window.setTimeout(l,8e3),i((0,Q.dK)()),n.current=!0}),[i,l]),u=(0,a.useCallback)((e=>{t.current=e,e||n.current||c()}),[c]);return(0,a.useEffect)((()=>{o&&c()}),[o,c]),(0,a.useMemo)((()=>({hideNudge:c,showNudge:d,setShouldKeepShowingNudge:u,isNudgeVisible:s})),[c,d,u,s])};var Qe=n(83022),qe=n(93794);const Ke="uETBcNmdHUHF_YPLJfOx",He="kb2DrVIixaicEzk6sEcP",Ze="PmEpl43j3MvwvoqnnZ6A",Ye="zWPenObFu5ZjWvtk_qSb",We=({onClose:e,onActionButtonClick:t,onMouseEnter:n,onMouseLeave:i,message:s,title:r,users:o,discoveryMethod:c})=>{const{spec:m,logger:g}=(0,S.r)(Qe.m,{}),p=(0,a.useMemo)((()=>m.nudgeScanningTooltipFactory({reason:c})),[c,m]);(0,a.useEffect)((()=>{g.logImpression(p.impression())}),[g,p]);const h=(0,a.useCallback)((()=>{g.logInteraction(p.closeButtonFactory().hitUiHide()),e?.()}),[g,p,e]),y=(0,a.useCallback)((()=>{g.logInteraction(p.joinButtonFactory().hitJoinSocialListeningSession()),t()}),[g,t,p]);return(0,v.jsxs)("div",{className:Ke,onMouseEnter:n,onMouseLeave:i,children:[(0,v.jsxs)("div",{className:He,children:[o.length>0&&(0,v.jsx)(qe.g,{users:o}),(0,v.jsx)(l.E,{as:"p",variant:"bodyMediumBold",semanticColor:"textBase",className:Ze,children:r}),(0,v.jsx)(ne.H,{iconOnly:ae.M,size:"small",semanticColor:"textBase",onClick:h,"aria-label":u.Ru.get("close")})]}),(0,v.jsx)(l.E,{id:"nudgeBody",as:"p",variant:"bodySmall",semanticColor:"textBase",children:s}),(0,v.jsx)("div",{className:Ye,children:(0,v.jsx)(d.$,{colorSet:"invertedLight",size:"small",onClick:y,children:u.Ru.get("web-player.social-connect.join-modal.button-primary")})})]})};var Xe=n(96869);const Je="_eXNo3nLWPbXuTHH7K08",$e="VT_giL9ITyvqFuzZsmWk",et="m5mgkcoKawOAJIWj0JE7",tt=({onActionButtonClick:e,onMouseEnter:t,onMouseLeave:n,message:i,onShow:s})=>{const{spec:r,logger:o}=(0,S.r)(Qe.m,{});(0,a.useEffect)((()=>{s?.(),o.logImpression(r.nudgeBroadcastingTooltipFactory().impression())}),[o,s,r]);const c=(0,a.useCallback)((()=>{o.logInteraction(r.nudgeBroadcastingTooltipFactory().changeButtonFactory().hitUiReveal()),e?.()}),[o,e,r]);return(0,v.jsxs)("div",{className:Je,onMouseEnter:t,onMouseLeave:n,children:[(0,v.jsx)(Xe.h,{size:"medium",className:$e}),(0,v.jsx)(l.E,{id:"nudgeBody",as:"p",variant:"bodySmall",semanticColor:"textBase",children:i}),(0,v.jsx)("div",{className:et,children:(0,v.jsx)(d.$,{colorSet:"invertedLight",size:"small",onClick:c,children:u.Ru.get("web-player.social-connect.broadcasting.session-is-being-broadcasted-nudge-button")})})]})},nt=({children:e,useNudgeTriggers:t=Ve,useToggleNudgeWithTimer:n=Ge,useCanShowNudge:i=le,disabled:s=!1})=>{const{showNudge:r,hideNudge:o,setShouldKeepShowingNudge:c,isNudgeVisible:l}=n(),[d,u]=(0,a.useState)(null),m=i();(0,a.useEffect)((()=>{l&&!m&&o()}),[m,o,l]),t((e=>!(l||!m)&&(u(e),r(),!0)));const g=(0,a.useCallback)((e=>{if(!e)return(0,v.jsx)(v.Fragment,{});const t=()=>{e?.onClose?.(),o()};if("join-listening-session-nudge"===e.nudgeType){const n=()=>{e.onActionButtonClick?.(),o()};return(0,v.jsx)(We,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:t,onActionButtonClick:n})}if("session-is-being-broadcasted-nudge"===e.nudgeType){const n=()=>{e.onShow?.()};return(0,v.jsx)(tt,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:t,onShow:n})}return(0,v.jsx)(re,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:t})}),[o,c]);return(0,v.jsx)(te.W,{maxWidth:"join-listening-session-nudge"===d?.nudgeType?450:void 0,placement:"top",visible:Boolean(d?.message)&&l&&!s,overlay:g(d),popperOptions:{modifiers:[{name:"preventOverflow",options:{rootBoundary:"viewport",altAxis:!0,padding:24,tether:!1}}]},onHide:()=>{},fadeOut:!0,useLazyMounting:!0,children:e})};var at=n(65282);const it=()=>{const{remoteDeviceType:e,remoteDeviceIsGroup:t,connectionStatus:n}=(0,R.v)((e=>{const t=(0,E.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceIsGroup:t.remoteDevice?.isGroup,connectionStatus:t.connectionStatus}}),P.a),i=(0,$.g)(),{canTogglePanel:s,isActive:r,togglePanel:o}=(0,ee.C)(),{spec:c,logger:l}=(0,S.r)(J.p,{}),d=(0,a.useCallback)((()=>{const{interactionId:e}=l.logInteraction(function(e,t,n){let a;return a=t===N.zP.CONNECTING?e.connectingButtonFactory():t===N.zP.CONNECTED?e.connectedButtonFactory():e.notConnectedButtonFactory(),n?a.hitUiHide():a.hitUiReveal()}(c,n,r));o(e)}),[n,o,r,c,l]),{currentDevice:m}=(0,at.l)(),{isLocal:g}=m,p=(0,a.useMemo)((()=>(0,C.tf)(e,t,g?i:null)),[i,g,t,e]);return(0,v.jsx)(nt,{children:(0,v.jsx)(H.f,{isActive:r,disabled:!s,onToggle:d,label:u.Ru.get("playback-control.connect-picker"),icon:p})})};var st=n(15472),rt=n(39092);var ot=n(48151);const ct=Me.$S.PUFFIN_BUTTON_CLICK,lt=Me.$S.DEVICE_PICKER_BUTTON_CLICK,dt=()=>{const{isPuffinPanelActive:e}=(0,ot.c)(),{isActive:t,panelSend:n}=(0,Fe.AI)(Ue.Z.DevicePicker,Ue.Z.DevicePickerOverlay),i=(0,Fe.Ev)(ct),{remoteDeviceType:s,remoteDeviceisGroup:r}=(0,R.v)((e=>{const t=(0,E.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceisGroup:t.remoteDevice?.isGroup}}),P.a),o=(0,$.g)(),c=o?.audioDevice.terminalType===xe.FI.HEADPHONES,l=(()=>{const{deviceFilterState:e}=(0,rt.j)();return e.currentState.externalizationEnabled||e.currentState.specificEnabled})(),d=t||e,m=l||c,{currentDevice:g}=(0,at.l)(),{isLocal:p}=g,h=(0,a.useMemo)((()=>l?st.C:(0,C.tf)(s,r,p?o:null)),[o,l,r,s,p]);return(0,v.jsx)(H.f,{isActive:d,isActiveNoIndicator:m,onToggle:()=>{const e=t;n(lt),e||(0,x.I)("DEVICE-PICKER")},label:u.Ru.get("playback-control.connect-picker"),icon:h,disabled:!i,restoreFocusKey:e?Ue.Z.Puffin:Ue.Z.DevicePicker})};var ut=n(56721),mt=n(98962);const gt=()=>{const{isAnonymous:e}=(0,r.d4)(mt.Ht),t=(0,ut.v)();return e?null:t?(0,v.jsx)(a.Suspense,{fallback:null,children:(0,v.jsx)(dt,{})}):(0,v.jsx)(it,{})};var pt=n(57546),vt=n(61176),ht=n(58336),yt=n(95132),bt=n(90630);const ft=a.memo((({onClick:e,className:t,isActive:n,isEnabled:a})=>{const i=a?u.Ru.get("web-player.lyrics.title"):u.Ru.get("web-player.lyrics.noLyrics1"),s=a?e:void 0;return(0,v.jsx)(H.f,{className:t,isActive:n,onToggle:s,disabled:!a,label:i,testId:"lyrics-button",icon:pt.q})})),xt=a.memo((e=>{const t=Boolean((0,yt.J)().data?.hasLyrics);return(0,v.jsx)(ft,{...e,isEnabled:t,isActive:!1})})),kt=a.memo((e=>{const t=(0,Y.o)((e=>e?.item?.uri)),n=Boolean((0,ht.f)(t).hasLyrics);return(0,v.jsx)(ft,{...e,isEnabled:n,isActive:!1})})),Ct=a.memo((e=>{const{isActive:t}=(0,vt.$)(),{isAnonymous:n}=(0,r.d4)(mt.Ht),a=(0,z.NC)(bt.khs),i=(0,Y.o)((e=>{if(e?.item?.uri&&(0,De.U_m)(e?.item?.uri)){return!Boolean(e?.item?.metadata?.["segment.index"])}return!1}));return n||!i?null:t?(0,v.jsx)(ft,{...e,isActive:!0,isEnabled:!0}):a?(0,v.jsx)(xt,{...e}):(0,v.jsx)(kt,{...e})}));var Nt=n(74911);const St=({onClick:e,className:t})=>{const{toggleLyrics:n}=(0,Nt.A)({onChange:e,referrer:"now_playing_bar"});return(0,v.jsx)(Ct,{onClick:n,className:t})};var jt=n(16547),It=n(88726),wt=n(90843);const At=Me.$S.NPV_BUTTON_CLICK,Dt=({onClick:e})=>{const{isActive:t,panelSend:n}=(0,Fe.AI)(Ue.Z.NowPlayingView),a=(0,Fe.Ev)(At),{mode:i,setMode:s}=(0,It.r)(),r=(0,z.NC)(bt.ZDY),{item:o}=(0,Y.o)((e=>({item:e?.item})),((e,t)=>e.item?.uri===t.item?.uri)),c=!o||!a;return r?null:(0,v.jsx)(H.f,{isActive:t,disabled:c,onToggle:()=>{e?.(!t),n(At),i===wt.YU.cinema&&s(wt.YU.npv)},icon:jt.d,label:u.Ru.get("web-player.now-playing-view.label"),testId:"control-button-npv",restoreFocusKey:Ue.Z.NowPlayingView})};var Tt=n(85387),Et=n(345),Rt=n(36002),Lt=n(2755),Pt=n(20256),Bt=n(36663),_t=n(21171);const Ot=({uri:e,to:t,children:n,onDrop:i,onNavigate:s,className:o})=>{const[c,l]=(0,a.useState)(!1),d=(0,a.useRef)(null),u=(0,Tt.Zp)(),m=(0,r.wA)(),g=(0,Bt.f)(),p=(0,_t.g)(),h=(0,ve.z)(),y=function(e){const t=(0,De.o_h)(e),n=(0,r.d4)(mt.F6);switch(t?.type){case De.NQG.PLAYLIST:case De.NQG.PLAYLIST_V2:{let e;if((0,De.iwx)(t)&&(e=t.username),n&&e===n)return[Pt.Ay[De.NQG.TRACK],Pt.Ay[De.NQG.LOCAL],Pt.Ay[De.NQG.ALBUM]];break}case De.NQG.COLLECTION:return[Pt.Ay[De.NQG.TRACK],Pt.Ay[De.NQG.ALBUM],Pt.Ay[De.NQG.ARTIST],Pt.Ay[De.NQG.PLAYLIST],Pt.Ay[De.NQG.PLAYLIST_V2],Pt.Ay[De.NQG.SHOW]];case De.NQG.QUEUE:return[Pt.Ay[De.NQG.TRACK],Pt.Ay[De.NQG.LOCAL],Pt.Ay[De.NQG.EPISODE]];default:return[]}return[]}(e),b=!!y.length;return(0,a.useEffect)((()=>(c?d.current=window.setTimeout((()=>{(0,De.U_m)(e)||(s?.(),u(t||(0,De.o_h)(e).toURLPath(!0)))}),1e3):!c&&d.current&&clearTimeout(d.current),()=>{d.current&&clearTimeout(d.current)})),[c,e,t,s,u]),b?(0,v.jsx)(Lt.A,{types:y,onDrop:t=>{const n=(0,De.o_h)(e),a=Array.from(t.dataTransfer.types).find((e=>y.includes(e))),s=a&&t.dataTransfer.getData(a),r=s&&s.split("\n")[0],o=(0,De.o_h)(r);if(o&&n)switch(i?.(o.toURI()),n.type){case De.NQG.PLAYLIST:case De.NQG.PLAYLIST_V2:m((0,Rt.io)(e,[o.toURI()]));break;case De.NQG.COLLECTION:(0,De._Tv)(o)||(0,De.ecE)(o)||(0,De.U_m)(o)?g.add({uris:[o.toURI()]}):(0,De.tbX)(o)?p.add([o.toURI()],{before:"start"}):(0,De.WB1)(o)&&g.add({uris:[o.toURI()]});break;case De.NQG.QUEUE:h.addToQueue([{uri:o.toURI(),uid:null}])}},onDragEnter:()=>{l(!0)},onDragLeave:()=>{l(!1)},className:o,children:n}):(0,v.jsx)("div",{children:n})};var Ft=n(56116);function Mt({style:e,active:t,disabled:n,intent:i,label:s,labelActive:r,icon:o,iconActive:c,className:l,onClick:d}){const[u,m]=(0,a.useState)(!1),g=(0,Ft.W)(),p=t&&r?r:s,h=t&&c?c:o;return(0,v.jsx)(H.f,{style:e,className:l,isActive:t,disabled:n,onToggle:e=>{d?.(),u||e.target.blur(),m(!1),i&&g({type:"click",intent:i,targetUri:""})},onKeyDown:({key:e})=>{"enter"===e.toLowerCase()&&m(!0)},label:p,icon:h,testId:`control-button-${i}`})}var Ut=n(69299),zt=n(39150),Vt=n(4298),Gt=n(32377);const Qt=()=>{const{isAnonymous:e}=(0,r.d4)(mt.Ht),{videoPlayerMode:t}=(0,zt.d)();return e||t===Vt.K.cinemaLegacy?{isVisible:!1}:{isVisible:!0,isEnabled:!0}},qt=({onClick:e})=>{const{isEnabled:t,isVisible:n}=Qt(),i=(0,Tt.zy)(),s=(0,Gt.J)(),r=(0,Tt.Zp)(),o=(0,a.useMemo)((()=>"/queue"===i.pathname||"/history"===i.pathname),[i.pathname]),c=(0,a.useCallback)((()=>{const t=s.entries?.slice(0,s.index+1)?.reverse()?.findIndex((({pathname:e})=>"/queue"!==e&&"/history"!==e));e({mode:"main",route:null}),r(-1===t?"/":t>=0?-t:-1)}),[r,s,e]),l=(0,a.useCallback)((()=>{e({mode:"main",route:"/queue"}),r("/queue",{state:{referrer:"now_playing_bar"}})}),[e,r]),d=(0,a.useCallback)((()=>{t&&(o?c():l())}),[t,o,c,l]);return n?(0,v.jsx)(Ot,{uri:"spotify:queue",children:(0,v.jsx)(Mt,{intent:"queue",icon:Et.j,label:u.Ru.get("playback-control.queue"),onClick:d,active:o,disabled:!t})}):null},Kt=Me.$S.QUEUE_BUTTON_CLICK,Ht=({onClick:e})=>{const{isEnabled:t,isVisible:n}=Qt(),i=(0,Fe.Ev)(Kt),{isActive:s}=(0,Fe.AI)(Ue.Z.Queue,Ue.Z.QueueOverlay),{toggleQueue:r}=(0,Ut.R)(),o=(0,a.useCallback)((()=>{t&&(e({mode:"panel",aboutToShow:!s}),r())}),[t,e,s,r]);return n?(0,v.jsx)(Ot,{uri:"spotify:queue",children:(0,v.jsx)(H.f,{icon:Et.j,label:u.Ru.get("playback-control.queue"),onToggle:o,isActive:s,disabled:!t||!i,testId:"control-button-queue",restoreFocusKey:Ue.Z.Queue})}):null},Zt=({onClick:e})=>(0,z.NC)(bt.eWj)?(0,v.jsx)(Ht,{onClick:e}):(0,v.jsx)(qt,{onClick:e});var Yt=n(80545),Wt=n(30542),Xt=n(69166);const Jt=({onClick:e})=>{const{item:t}=(0,Wt.L)()??{},{isActive:n,onClick:a,showButton:i}=(0,Xt.D)({item:t,onClick:e});return t&&i?(0,v.jsx)(H.f,{isActive:n,onToggle:a,label:n?u.Ru.get("miniplayer.close"):u.Ru.get("miniplayer.open"),icon:Yt.F,testId:"pip-toggle-button"}):null};var $t=n(63261),en=n(46775);const tn="mwpJrmCgLlVkJVtWjlI1",nn="Xmv2oAnTB85QE4sqbK00",an="ExuDUBJ7bk8vT6INnm9F",sn=()=>{const e=(0,z.NC)(bt.yux),t=(0,z.NC)(bt.mzn),{setVideoPlayerUIFlag:n,videoPlayerMode:i}=(0,zt.d)(),{spec:s,logger:r,UBIFragment:o}=(0,S.r)(V.h9,{data:{identifier:i===Vt.K.cinemaLegacy?V.gw.CINEMA:V.gw.DESKTOP}}),c=(0,U.YQ)((e=>{r.logInteraction(s.volumeBarFactory().dragSetVolume({newVolumePercentage:Math.floor(100*e)}))}),500,{leading:!1,trailing:!0}),l=(0,a.useCallback)((e=>{e&&n(Vt.n.cinemaLegacy,!1)}),[n]);return(0,v.jsx)(o,{spec:s,children:(0,v.jsxs)("div",{className:tn,children:[(0,v.jsx)(en.mA,{onClick:()=>{r.logInteraction(s.djJumpButtonFactory().hitRefreshContent())}}),(0,v.jsx)(Dt,{onClick:e=>{e?r.logInteraction(s.npvButtonFactory().hitUiReveal()):r.logInteraction(s.npvButtonFactory().hitUiHide())}}),!e&&(0,v.jsx)(St,{className:nn,onClick:e=>{e?r.logInteraction(s.lyricsButtonFactory().hitUiNavigate({destination:e})):r.logInteraction(s.lyricsButtonFactory().hitUiNavigateBack())}}),(0,v.jsx)(Zt,{onClick:e=>{"main"===e.mode?e.route?r.logInteraction(s.queueButtonFactory().hitUiNavigate({destination:e.route})):r.logInteraction(s.queueButtonFactory().hitUiNavigateBack()):e.aboutToShow?r.logInteraction(s.queueButtonFactory().hitUiReveal()):r.logInteraction(s.queueButtonFactory().hitUiHide())}}),(0,v.jsx)(gt,{}),(0,v.jsx)($t.M,{className:an,onVolumeBarClick:e=>{r.logInteraction(s.volumeBarFactory().hitSetVolume({newVolumePercentage:Math.floor(100*e)}))},onToggleMuteClick:e=>{"muted"===e?r.logInteraction(s.volumeMuteButtonFactory().hitMutePlayback()):"not_muted"===e&&r.logInteraction(s.volumeMuteButtonFactory().hitUnmutePlayback())},onVolumeBarDrag:c}),(0,v.jsx)(Jt,{onClick:l}),!t&&(0,v.jsx)(X,{className:"control-button",disabledClassName:"control-button--disabled",onClick:e=>{e&&r.logInteraction(s.fullscreenButtonFactory().hitUiReveal())}})]})})};var rn=n(84700),on=n(88878),cn=n(78172);const ln="yyrJTUPMeLS8qs1a0YJr",dn=({logoUrl:e})=>e?(0,v.jsx)("div",{className:ln,"data-testid":"context-ad-logo",children:(0,v.jsx)(on.N,{loading:"eager",imgSrc:e,width:56,height:56,type:cn.c.AD})}):null;var un=n(48367),mn=n(10325),gn=n(85271);const pn=({item:e,context:t,index:n})=>{const{logoImage:a}=(0,un.b)(e);return(0,v.jsx)(gn.e,{item:e,context:t,index:n,"aria-label":u.Ru.get("ad-formats.advertisement"),adEventReason:mn.c.AD_LOGO,isVisible:!1,children:(0,v.jsx)(dn,{logoUrl:a})})};var vn=n(66917),hn=n(67759);const yn=a.memo((function({uri:e,className:t,onClick:n,size:i=vn.t.xs}){const[s,r]=(0,hn.A)(e),o=(0,Ft.W)(),c=(0,a.useCallback)((t=>{t.preventDefault(),o({targetUri:e,intent:s?"remove-from-library":"add-to-library",type:"click"}),n&&n(!s),r(!s)}),[o,e,s,n,r]);return(0,v.jsx)(vn.M,{className:t,size:i,onClick:c,isAdded:!!s,condensed:!0})}));var bn=n(10161),fn=n(81875),xn=n(28552);const kn=({uri:e,isBook:t=!1,size:n=vn.t.xs,className:i,onClick:s})=>{const{isPreSaved:r,addPresave:o,removePresave:c}=(0,xn.w)({uri:e,isBook:t}),l=(0,a.useCallback)((()=>{r?c():o(),s?.(!r)}),[r,s,c,o]);return(0,v.jsx)(vn.M,{className:i,size:n,onClick:l,isAdded:!!r,condensed:!0})};var Cn=n(31531),Nn=n(96205),Sn=n(25425),jn=n(40099),In=n(12367),wn=n(21204),An=n(71592),Dn=n(56106),Tn=n(18168),En=n(23046),Rn=n(75784);function Ln(e){return(0,Rn.v)(e)||(0,En.p)(e)}var Pn=n(32636),Bn=n(16512),_n=n(18492);const On=Me.$S.NPV_BUTTON_CLICK,Fn=()=>{const e=(0,Bn.l)(),t=(0,_n.S)(),n=(0,Fe._Y)();return(0,a.useCallback)((()=>{t!==Pn.z.CLOSED?e(Pn.z.CLOSED):n(On)}),[t,n,e])};var Mn=n(23995),Un=n(53575);const zn="deomraqfhIAoSB3SgXpu",Vn="IcyWfMS5VkeOhaI7OWIx",Gn="BFR9Zt3zpL8BATBMiwQB",Qn="j96cpCtZAIdqxcDrYHPI",qn="HD9s7U5E1RLSWKpXmrqx",Kn=({onClick:e})=>{const t=(0,Wt.L)(),{draggable:n,onDragStart:a}=(0,Un.P)(),{isActive:i}=(0,Fe.AI)(Ue.Z.NowPlayingView),s=Fn(),{images:r}=(0,Mn.u)(t?.item);if(null===t)return null;const{context:o,item:c}=t;return(0,v.jsx)(In.h,{menu:(0,v.jsx)(An.W,{context:o,item:c}),children:(0,v.jsx)("div",{draggable:n&&Ln(c),onDragStart:e=>{a(e,{itemUris:[c.uri],dragLabelText:(0,Tn.r)(c)})},children:(0,v.jsx)(Dn.R,{uri:o.uri,owner:o.metadata?.context_owner,children:(0,v.jsx)("button",{type:"button","data-testid":"cover-art-button",className:qn,"aria-label":u.Ru.get("web-player.now-playing-view.label"),onClick:()=>{s(),e?.(i)},children:(0,v.jsx)(wn.b,{images:r,type:c.type,size:56,maxSize:56,className:Gn})})})})})};var Hn=n(87422),Zn=n(74133),Yn=n(89913);const Wn="GQ5_gIWzIqAfBdmQm8yJ",Xn="_9sCL61nGvQFXv2u02jXw",Jn=Me.$S.NPV_BUTTON_CLICK,$n=({children:e,className:t})=>{const n=(0,Fe.Ev)(Jn),{isActive:i}=(0,Fe.AI)(Ue.Z.NowPlayingView),r=Fn(),o=(0,a.useMemo)((()=>i?{label:u.Ru.get("npb.collapseCoverArt"),Icon:Zn.r}:{label:u.Ru.get("npb.expandCoverArt"),Icon:Hn.o}),[i]);return(0,v.jsxs)("div",{"data-testid":"CoverSlotCollapsed__container",className:s()(Wn,t),children:[e,(0,v.jsx)(Yn.Zp,{label:o.label,children:(0,v.jsx)("button",{className:s()(Xn),disabled:!n,onClick:r,"aria-label":u.Ru.get("web-player.now-playing-view.label"),"aria-pressed":i,children:(0,v.jsx)(o.Icon,{iconSize:16})})})]})};var ea=n(70196),ta=n(16408),na=n(80600);var aa=n(46198),ia=n(86324),sa=n(12200),ra=n(82414),oa=n(56226),ca=n(24320),la=n(42262),da=n(52596);const ua=({context:e,item:t,onLike:n})=>{const a=(0,sa.X)(),i=(0,Nn.v)(t);if(a&&(0,ia.N)(t))return(0,v.jsx)(aa.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0});if(i)return(0,v.jsx)(Cn.g,{uri:t.uri,condensed:!1});if((0,Rn.v)(t))return t.isLocal?null:(0,v.jsx)(fn.b,{uri:t.uri,className:"control-button control-button-heart",onClick:n});if((0,En.p)(t))return(0,v.jsx)(bn.b,{uri:t.uri,className:"control-button control-button-heart",onClick:n,condensed:!0});if((0,oa.d)(t)){return"trailer"===t?.metadata?.type&&"true"===t?.metadata?.is_pre_release?(0,v.jsx)(kn,{uri:t.book.uri,isBook:!0,className:"control-button control-button-heart",onClick:n}):(0,v.jsx)(yn,{uri:t.book.uri,className:"control-button control-button-heart",onClick:n})}return(0,ra.N)(t)||(0,ca.v)(t)?null:(0,da.d)(t)},ma=({state:{item:e,context:t,index:n}})=>{!function(e){const t=(0,na.i)(),n=(0,ta.X)(e);(0,a.useEffect)((()=>{n&&t.say(n)}),[n,t])}(e);const{videoPlayerMode:i,setVideoPlayerUIFlag:s}=(0,zt.d)(),{spec:r,logger:o}=(0,S.r)(rn.p6,{data:{identifier:i===Vt.K.cinemaLegacy?rn.gw.CINEMA:rn.gw.DESKTOP}}),c=(0,ta.P)(e),l=(0,z.NC)(bt.WAA);(0,a.useEffect)((()=>{s(Vt.n.nowPlayingBar,l)}),[l,s]);const d=i===Vt.K.nowPlayingBar&&l;return(0,v.jsx)(a.Suspense,{fallback:null,children:(0,v.jsx)("div",{"data-testid":"now-playing-widget",className:zn,role:"contentinfo","aria-label":c,children:(0,v.jsxs)(la.r,{spec:r,children:[(0,ra.N)(e)?(0,v.jsx)(pn,{item:e,context:t,index:n}):(0,v.jsxs)($n,{className:Vn,children:[!d&&(0,v.jsx)(Kn,{onClick:t=>{t?o.logInteraction(r.coverartFactory({uri:e.uri}).hitUiReveal()):o.logInteraction(r.coverartFactory({uri:e.uri}).hitUiHide())}}),l&&(0,v.jsx)("div",{id:"VideoPlayerNpb_ReactPortal"})]}),(0,v.jsx)(Sn.d,{context:t,className:Qn,item:e,size:"xsmall",enableVideoButton:!0,onTitleClick:t=>{o.logInteraction(r.titleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},onSubtitleClick:t=>{o.logInteraction(r.subtitleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},referrer:jn.G.NPB}),(0,v.jsx)(ea.a,{context:t,item:e,onClick:()=>{o.logInteraction(r.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:e.uri,contextUri:t.uri}))}}),(0,v.jsx)(ua,{item:e,onLike:t=>{o.logInteraction(t?r.likeButtonFactory({uri:e.uri}).hitLike({itemToBeLiked:e.uri}):r.likeButtonFactory({uri:e.uri}).hitRemoveLike({itemNoLongerLiked:e.uri}))},context:t})]})})})},ga=()=>{const e=(0,Wt.L)();return null===e?(0,v.jsx)("div",{className:s()("now-playing")}):(0,v.jsx)(ma,{state:e})};var pa=n(48455);const va="aguQsGoZR9wZeawKGdDh",ha="ieqOSqJb6kk3bG5XDOHk",ya=({paused:e,fromSeconds:t})=>{const[n,i]=(0,a.useState)(t);return(0,pa.$)((t=>{i((n=>e?n:n>0?n-1:(t(),n)))}),1e3),(0,v.jsxs)("div",{className:va,children:[u.Ru.get("ad-formats.skippable_ads.skip_countdown"),(0,v.jsx)("span",{className:ha,children:n})]})};var ba=n(14524);const fa=({children:e})=>{const t=(0,Y.o)((e=>e),((e,t)=>(0,P.a)(e?.restrictions,t?.restrictions)&&e?.item?.uri===t?.item?.uri&&e?.isPaused===t?.isPaused)),n=t?.restrictions.disallowSkippingNextReasons.includes("ad_disallow"),a=t?.isPaused??!1,i=(0,ba.qc)(t),s=(0,ba.Tv)(t),o=(0,r.d4)((e=>i?e?.ads?.audio?.info?.skippableAdDelaySeconds:s?e?.ads?.vto?.info?.skippableAdDelaySeconds:void 0));return n&&o?(0,v.jsx)(ya,{paused:!!a,fromSeconds:o}):(0,v.jsx)(v.Fragment,{children:e})};var xa=n(62238),ka=n(9159);var Ca=n(64612);const Na=e=>{const[t,n]=(0,a.useState)(new Map),[i,s]=(0,a.useState)(),r=(0,Ca.L)(),o=(0,ka.mr)(),{currentDevice:c}=(0,at.l)(),l=(0,Te.vh)(),d=(0,a.useCallback)((()=>{if(!e)return;const a=(({lastRecordedItem:e,setLastRecordedItem:t,recentAds:n,setRecentAds:a,playerStateItem:i,currentDevice:s})=>{let r={isMissingAdData:!1};if(i&&i.uri!==e?.uri){if(e?.type===cn.c.AD){const t=e?.uri.split(":")[2];n.has(t)?a((e=>{const n=new Map(e);return n.delete(t),n})):r={isMissingAdData:!0,errorMessage:s.isLocal?"primary_device":"secondary_device",adId:t}}t((()=>i))}return r})({lastRecordedItem:i,setLastRecordedItem:s,recentAds:t,setRecentAds:n,playerStateItem:r?.item,currentDevice:c});if(a.isMissingAdData){const{errorMessage:e,adId:t}=a;l.send((0,xa.G)({error_type:"missing_ad_data",error_message:e,slot:"stream",ad_id:t}))}}),[r,i,t,l,c,e]),u=(0,a.useCallback)((()=>{e&&o&&n((e=>{let n=e;return t.has(o.adId)||(n=new Map(e).set(o.adId,o)),n}))}),[t,o,e]);(0,a.useEffect)((()=>{d()}),[d]),(0,a.useEffect)((()=>{u()}),[u])};var Sa=n(67890),ja=n(7340),Ia=n(82371),wa=n(85162),Aa=n(76214),Da=n(21964),Ta=n(75756),Ea=n(46300),Ra=n(20890),La=n(59960);const Pa="gItY2hnfCB4TsDJCkPiO",Ba="XrZ1iHVHAPMya3jkB2sa",_a="NKUrT1GciYXAEEUtagN1",Oa="Qt226Z4rBQs53aedRQBQ",Fa=(0,a.memo)((function({item:e}){const t=wa.Q.isPodcastAd(e),n=wa.Q.isSurveyAd(e);return(0,v.jsxs)("div",{"data-testid":"ad-controls",className:Ba,children:[(0,v.jsxs)("div",{className:_a,children:[t&&(0,v.jsx)(La.w,{}),(0,v.jsx)(Ia.T,{item:e,isDisabled:n}),t?(0,v.jsx)(Da.h,{}):(0,v.jsx)(Ea.d,{})]}),(0,v.jsx)(Aa.x,{}),(0,v.jsxs)("div",{className:Oa,children:[t?(0,v.jsx)(Ta.v,{}):(0,v.jsx)(fa,{children:(0,v.jsx)(Ra.$,{})}),(0,v.jsx)(ja.t,{item:e,isDisabled:n})]})]})}));var Ma=n(28787),Ua=n(16825),za=n(20714),Va=n(5830),Ga=n(24312),Qa=n(16203);var qa=n(38849),Ka=n(3128),Ha=n(79707);const Za="JbGNL7qsnWz6EP_3hGvf",Ya="mkROcxw9LM6F2uuwQYjN",Wa=e=>{const{className:t,...n}=e;return(0,v.jsx)("span",{className:Ya,children:(0,v.jsx)(Ha.x,{className:s()(t),...n})})};var Xa=n(55669),Ja=n(4317),$a=n(56695),ei=n(67990),ti=n(87406),ni=n(52975),ai=n(40387);const ii=function({setSleepTimer:e,state:t}){const n=t.type===ti.k.Off?ei.X:ei.X.concat(ti.k.Off);return(0,v.jsxs)(Xa.W,{children:[(0,v.jsx)(Ja.y,{children:u.Ru.get("web-player.sleep-timer.player-controls.popover.title")}),(0,v.jsx)("div",{children:n.map((n=>(0,v.jsx)($a.D,{onClick:()=>{e(n)},"data-testid":`playback-sleep-timer-option-${n}`,role:"menuitemradio","aria-label":`${n}`,"aria-checked":t.type===n,children:t.type===n?(0,ai.J)(n,t.endsAt,cn.c.EPISODE):(0,ni.p)(n,cn.c.EPISODE)},n)))})]})};var si=n(51496);const ri=e=>e-Date.now(),oi=({endsAt:e})=>{const[t,n]=(0,a.useState)(ri(e));return(0,a.useEffect)((()=>{n(ri(e));const t=setInterval((()=>{n(ri(e))}),1e3);return()=>{clearInterval(t)}}),[e]),(0,v.jsx)(l.E,{variant:"marginal",semanticColor:"textBrightAccent",children:(0,si.f)(t)})};var ci=n(89783);const li=({onClick:e})=>{const t=(0,z.NC)(bt.GhO),[n,a]=(0,ci.y)(),i=n.type!==ti.k.Off,{endsAt:s}=n;return t?(0,v.jsx)(Ka.t,{placement:"top-start",menu:(0,v.jsx)(ii,{state:n,setSleepTimer:t=>{a(t),e?.(t)}}),children:(e,t,n)=>(0,v.jsx)(Yn.Zp,{label:u.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),children:(0,v.jsx)(ne.H,{ref:n,className:Za,iconLeading:i?Wa:qa.l,size:"small",onClick:t,role:"checkbox","aria-label":u.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),"data-testid":"control-button-sleep-timer","aria-checked":i,semanticColor:i?"textBrightAccent":void 0,children:i&&s&&(0,v.jsx)(oi,{endsAt:s})})})}):null};var di=n(92450),ui=n(21085);const mi=(0,a.memo)((function({isPreview:e}){const{logChangePlaybackSpeed:t,logChangeRepeatMode:n,logChangeShuffleMode:i,logSeekForward:s,logSeekBack:r,logSkipForward:o,logSkipBack:c,logPlayPause:l,logProgressChanged:d,spec:m}=(()=>{const e=(0,ve.z)(),{videoPlayerMode:t}=(0,zt.d)(),{spec:n,logger:i}=(0,S.r)(Va.kD,{data:{identifier:t===Vt.K.cinemaLegacy?Va.gw.CINEMA:Va.gw.DESKTOP}});return{logChangePlaybackSpeed:(0,a.useCallback)((t=>{const a=e.getState();a?.item&&i.logInteraction(n.speedControlButtonFactory().hitSetPlaybackSpeed({currentlyPlayedItem:a.item.uri,playbackSpeed:t}))}),[i,e,n]),logChangeShuffleMode:(0,a.useCallback)((e=>{i.logInteraction(e?n.shuffleButtonFactory().hitShuffleEnable():n.shuffleButtonFactory().hitShuffleDisable())}),[i,n]),logChangeRepeatMode:(0,a.useCallback)((e=>{const t={[Ga.p.REPEAT_NONE]:n.repeatButtonFactory().hitRepeatDisable(),[Ga.p.REPEAT_TRACK]:n.repeatButtonFactory().hitRepeatOneEnable(),[Ga.p.REPEAT_CONTEXT]:n.repeatButtonFactory().hitRepeatEnable()};i.logInteraction(t[e])}),[i,n]),logSeekBack:(0,a.useCallback)((e=>{i.logInteraction(n.seekBackButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[i,n]),logSeekForward:(0,a.useCallback)((e=>{i.logInteraction(n.seekForwardButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[i,n]),logSkipBack:(0,a.useCallback)((()=>{const t=e.getState();t&&i.logInteraction(n.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:t.item?.uri||"",positionMs:(0,Qa.s)(t)??-1,totalContentMs:t.duration??-1}))}),[i,e,n]),logSkipForward:(0,a.useCallback)((()=>{const t=e.getState();t?.item&&i.logInteraction(n.nextButtonFactory().hitSkipToNext({itemToBeSkipped:t.item.uri,positionMs:(0,Qa.s)(t)??-1,totalContentMs:t.duration??-1}))}),[i,e,n]),logPlayPause:(0,a.useCallback)((t=>{const a=e.getState();a?.item&&("resume"===t?i.logInteraction(n?.playPauseButtonFactory().hitResume({itemToBeResumed:a.item.uri})):"pause"===t&&i.logInteraction(n?.playPauseButtonFactory().hitPause({itemToBePaused:a.item.uri})))}),[i,e,n]),logProgressChanged:(0,a.useCallback)(((e,t)=>{switch(t){case"drag":return i.logInteraction(n.progressBarFactory().dragSeekToTime({msToSeekTo:e}));case"hit":return i.logInteraction(n.progressBarFactory().hitSeekToTime({msToSeekTo:e}));default:return(0,da.k)(t)}}),[i,n]),spec:n}})();Na((0,z.NC)(bt.KYh));const g=(0,Y.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri)),p=(0,za.p)();return(0,v.jsx)("div",{className:Pa,"data-testid":"player-controls",dir:"ltr","aria-label":u.Ru.get("playback-control.a11y.landmark-label"),children:(0,v.jsxs)(la.r,{spec:m,children:[(0,ra.N)(g)?(0,v.jsx)(Fa,{item:g}):(0,v.jsxs)("div",{className:Ba,"data-testid":"general-controls",children:[(0,v.jsxs)("div",{className:_a,children:[p?(0,v.jsx)(La.w,{onClick:t}):(0,v.jsx)(ui.w,{renderEnabled:()=>(0,v.jsx)(di.a,{size:"small"}),renderDisabled:()=>(0,v.jsx)(Ua.u,{onClick:i})}),p&&(0,v.jsx)(Da.h,{onClick:r}),(0,v.jsx)(Ea.d,{onClick:c})]}),(0,v.jsx)(Aa.x,{onClick:l}),(0,v.jsxs)("div",{className:Oa,children:[(0,v.jsx)(fa,{children:(0,v.jsx)(Ra.$,{onClick:o})}),p?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(Ta.v,{onClick:s}),(0,v.jsx)(li,{})]}):(0,v.jsx)(Ma.s,{onClick:n})]})]}),(0,v.jsx)(Sa.x,{isPreview:e,onChange:d})]})})}));var gi=n(24395),pi=n(42372),vi=n(77612),hi=n(13946);const yi="yglmI5m3fCc8baD1Kwdw",bi="udArIAqnfUQPQew2VAns",fi="MWD1i_CSJ5N9wRBDpZmX",xi="k3NVrHXkbfflNdAxpT1_",ki="m8UPWsNtWbdkvBNvqgBN",Ci="aepuRyT82biv_XmkH1eS",Ni="snFK6_ei0caqvFI6As9Q",Si="sVv2OQORCQ4kf6iKfUTF",ji="pLifNBuHRY8cZkZyEqwL",Ii="K7b2iysmIbvKo8RqRbc5",wi="adzMqeRxU0__wQcuju5q",Ai=(0,a.memo)((()=>{const{isAnonymous:e}=(0,r.d4)(mt.Ht),t=(0,r.wA)(),n=(0,Y.o)((e=>e),((e,t)=>e?.hasContext===t?.hasContext&&e?.item?.uri===t?.item?.uri)),i=(0,y.h)(),l=(0,Y.o)((e=>(0,ra.N)(e?.item??void 0))),d=(0,a.useCallback)((e=>{e.stopPropagation(),t((0,c.Ai)())}),[t]),u=()=>(0,v.jsx)(pi.ql.Provider,{value:"now_playing_bar",children:(0,v.jsxs)("div",{className:e?fi:bi,children:[(0,v.jsx)("div",{className:Ni,children:(0,v.jsx)(ga,{})}),(0,v.jsx)("div",{className:Si,children:(0,v.jsx)(a.Suspense,{fallback:null,children:(0,v.jsx)(mi,{isPreview:e})})}),(0,v.jsx)("div",{className:ji,children:(0,v.jsx)(sn,{})})]})});return(0,v.jsx)(hi.P,{surface:vi.u.NOW_PLAYING,children:(0,v.jsx)(gi.pZ,{value:"now-playing-bar",children:(0,v.jsxs)("footer",{className:s()(yi,Ii,{[wi]:i}),"data-testid":"now-playing-bar","data-testadtype":"ad-type-"+(l?"ad":"none"),children:[e?(0,v.jsx)(gi.pZ,{value:"preview-bar",children:(0,v.jsx)(h,{handleClick:d})}):null,e?(0,v.jsx)(o.A,{in:n?.hasContext??!1,timeout:200,classNames:{enter:xi,enterActive:ki,enterDone:Ci},children:u()}):u(),(0,v.jsx)(M,{})]})})})}))},56106:(e,t,n)=>{n.d(t,{R:()=>d});var a=n(30758),i=n(62411),s=n(72574),r=n(36002),o=n(2755),c=n(53575),l=n(86070);const d=({uri:e,owner:t,children:n})=>{const d=(0,i.wA)(),u=(0,i.d4)((e=>e.session.user?.id)),m=(0,s.tbX)(e),g=(0,a.useCallback)(((t,n)=>{const a=[...n[c.O[s.NQG.ALBUM]]||[],...n[c.O[s.NQG.TRACK]]||[],...n[c.O[s.NQG.LOCAL_TRACK]]||[],...n[c.O[s.NQG.EPISODE]]||[]];a.length>0&&d((0,r.io)(e,a))}),[d,e]);return m&&t===u?(0,l.jsx)(o.A,{types:[c.O[s.NQG.ALBUM],c.O[s.NQG.TRACK],c.O[s.NQG.EPISODE],c.O[s.NQG.LOCAL]],onDrop:g,testId:"cover-drop-target",children:n}):(0,l.jsx)(l.Fragment,{children:n})}},93794:(e,t,n)=>{n.d(t,{g:()=>p});var a=n(30758),i=n(97500),s=n.n(i),r=n(13505),o=n(93492),c=n(32284);const l="w0kwPDoelauN3C9dVoVe",d="xzLZD9uD3b4u9wecXAJY",u="DaFhhSm73r7rNpomErhI";var m=n(86070);const g=({children:e})=>(0,m.jsx)(m.Fragment,{children:e}),p=(0,a.forwardRef)((function({users:e,maxSlots:t=3,size:n,withoutOverflowBadge:a=!1,dropShadow:i=!1,AvatarWrapper:p=g},v){const h=Math.max(2,t),y=e.length>h?e.length-h+1:0,b=e.slice(0,h),{userIconSize:f,width:x,smallFontSize:k,largeFontSize:C}=(e=>{switch(e){case"xxlarge":return{userIconSize:"xlarge",width:64,smallFontSize:24,largeFontSize:32};case"xlarge":return{userIconSize:"large",width:48,smallFontSize:18,largeFontSize:24};case"large":return{userIconSize:"medium",width:32,smallFontSize:12,largeFontSize:16};case"medium":default:return{userIconSize:"small",width:24,smallFontSize:9,largeFontSize:12};case"small":return{userIconSize:"xsmall",width:18,smallFontSize:8,largeFontSize:10}}})(n),N=y>9?k:C,S=(0,m.jsx)("span",{className:s()(d,"encore-inverted-light-set"),style:{width:x,height:x},role:"presentation",children:(0,m.jsx)(r.E,{variant:"bodySmallBold",style:{fontSize:N},semanticColor:"textBase",children:`+${y}`})});return(0,m.jsx)("div",{className:s()(l),ref:v,children:b.map(((e,t)=>!a&&y>0&&t===h-1?(0,m.jsx)(p,{index:t,children:(0,m.jsx)(c.e,{images:[],userIconSize:f,label:o.Ru.get("web-player.social-connect.facepile.and-others",y),width:x,piled:!0,customPlaceholder:S})},"others"):(0,m.jsx)(p,{index:t,user:e,children:(0,m.jsx)(c.e,{images:e.images,userIconSize:f,label:e.displayName,displayName:e.displayName,username:e.username,width:x,piled:t>0,imageClassName:i?u:void 0})},e.displayName)))})}))},45649:(e,t,n)=>{n.d(t,{L:()=>r});var a=n(77901),i=n(9159),s=n(26906);const r=e=>{const t=(0,i.dY)(),n=(0,s.vh)(),r=t.getInStreamAd();return{logAdFeedback:function(t){n.send((0,a.F)({ad_id:e.id,advertiser:e.advertiser,creative_id:r?.adId===e.id?r?.metadata?.creative_id:void 0,format:e.mediaType,line_item_id:r?.adId===e.id?r?.metadata?.lineitem_id:void 0,event:t}))}}}},60410:(e,t,n)=>{n.d(t,{N:()=>r,T:()=>s});var a=n(42551);const i=e=>e.ads.adFeedback,s=(0,a.Mz)([e=>i(e),(e,t)=>t],((e,t)=>!(!t||e.adId!==t)&&e.liked)),r=(0,a.Mz)([e=>i(e),(e,t)=>t],((e,t)=>!(!t||e.adId!==t)&&e.disliked))},80478:(e,t,n)=>{n.d(t,{sY:()=>f,Nh:()=>b,bo:()=>x,r3:()=>y,EX:()=>h,lZ:()=>v});var a=n(3118),i=n(44947);n(49810);const s=new i.l("queryFullscreenMode","query","5d8427bc0f6f2f6b96521121faf162094c2a3f14f0511b5ca0628c6a5028a3ea",null);var r=n(90630),o=n(34668),c=n(82414),l=n(56226),d=n(23046),u=n(75784),m=n(24320),g=n(34756),p=n(52596);const v=()=>{const e=(0,a.NC)(r.WYm,{loadingValue:!1});return(0,o.o)(g.A3)||e};function h(e){return(0,u.v)(e)?{uri:e.uri,name:e.name,creatorName:e.artists[0]?.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,d.p)(e)?{uri:e.uri,name:e.name,creatorName:e.show.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,l.d)(e)?{uri:e.uri,name:e.name,creatorName:e.book.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,c.N)(e)?{uri:e.uri,name:e.title??"",creatorName:e.advertiser??"",coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,m.v)(e)||void 0===e?void 0:(0,p.d)(e)}function y(e){const t=h(e);return(0,u.v)(e)||(0,d.p)(e)||(0,l.d)(e)||(0,c.N)(e)?{...t,duration:e.duration.milliseconds,mediaType:(n=e.mediaType,"video"===n||"mixed"===n?"video":"audio")}:(0,m.v)(e)||void 0===e?void 0:(0,p.d)(e);var n}function b(e){const t=e?.context.metadata?.context_description,n=e?.context.uri||void 0,a=e?.positionAsOfTimestamp??void 0,i=e?.timestamp,s=e?.isPaused,r=e?.restrictions.canPause,o=e?.restrictions.canResume;return{contextName:t,contextUri:n,position:a,timestamp:i,isPaused:s,canPause:r,canResume:o}}async function f(e,t){return e(s,{artistUri:t}).then((e=>{if("Artist"===e?.data?.artistUnion.__typename){const t=e.data.artistUnion.headerImage;if("ImageV2"===t?.data?.__typename)return t?.data.sources[0]?.url}})).catch((()=>{}))}function x(e,t,n){if(e&&n&&n.hasLyrics)return{status:t?"loading":"success",content:{provider:n.provider,syncType:n.syncType,lines:n.lyrics.map((e=>({timestamp:Number(e.start),text:e.text})))}}}},28552:(e,t,n)=>{n.d(t,{w:()=>d});var a=n(30758),i=n(75690),s=n(93492),r=n(71338),o=n(49889),c=n(98866),l=n(82362);const d=({uri:e,isBook:t})=>{const{add:n,remove:d}=(0,c.p)("prerelease"),u=(0,o.o)("prerelease",[e]).at(0),{enqueueSnackbar:m}=(0,r.d)(),{spec:g,logger:p}=(0,l.r)(i.k,{data:{uri:e}});return{isPreSaved:u,addPresave:(0,a.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitPresave({prereleaseId:e,itemToBePresaved:e,contextUri:e})),await n(e),m(t?s.Ru.get("web-player.prerelease.audiobook_feedback_presaved"):s.Ru.get("web-player.prerelease.album_feedback_presaved"))}),[n,m,t,p,g,e]),removePresave:(0,a.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitRemovePresave({prereleaseId:e,itemToBeRemovedFromPresaved:e,contextUri:e})),await d(e)}),[p,d,g,e])}}},80600:(e,t,n)=>{n.d(t,{i:()=>s});var a=n(30758);class i{constructor(e={}){this.settings={level:e.level||"polite",parent:e.parent||document.body,idPrefix:e.idPrefix||"live-region-",delay:e.delay||0},this.currentRegion=document.createElement("span")}say(e,t=this.settings.delay){this.clearNode(),this.currentRegion=document.createElement("span"),this.currentRegion.id=this.settings.idPrefix+Math.floor(1e4*Math.random());const n="assertive"!==this.settings.level?"status":"alert";this.currentRegion.setAttribute("aria-live",this.settings.level),this.currentRegion.setAttribute("role",n),this.currentRegion.setAttribute("style","clip: rect(1px, 1px, 1px, 1px); height: 1px; overflow: hidden; position: absolute; white-space: nowrap; width: 1px"),this.settings.parent.appendChild(this.currentRegion),window.setTimeout((()=>{this.currentRegion.textContent=e}),t)}clearNode(){const e=this.settings.parent.querySelector(`[id^="${this.settings.idPrefix}"]`);e&&this.settings.parent.removeChild(e)}}const s=({delay:e,idPrefix:t,level:n,parent:s}={})=>{const r=(0,a.useMemo)((()=>new i({delay:e,idPrefix:t,level:n,parent:s})),[e,t,n,s]);return(0,a.useEffect)((()=>()=>{r.clearNode()}),[r]),r}},56454:(e,t,n)=>{n.d(t,{v:()=>r});var a=n(71086),i=n(23046),s=n(75784);function r(e){if("string"==typeof e)return(0,a.g)(e);const t=e;return(0,s.v)(t)||(0,i.p)(t)}},31531:(e,t,n)=>{n.d(t,{g:()=>a.g});var a=n(27)},96205:(e,t,n)=>{n.d(t,{v:()=>a.v});var a=n(56454)},51278:(e,t,n)=>{n.d(t,{g:()=>l});var a=n(30758),i=n(13982),s=n(91205),r=n(87578),o=n(53405),c=n(55666);function l(){const e=(0,r.V)(),t=(0,c.u)(),[n,l]=(0,a.useState)(null),d=(0,a.useCallback)((async()=>{const n=e.getDefaultDevice();if(null===n)return void l(null);if(n.transportType!==i.Yg.BLUETOOTH)return void l({audioDevice:n});const a=await t.lookup(n.name);l({audioDevice:n,externalAccessory:a})}),[e,t]);return(0,o.k)(s.B.DEVICE_CONNECTED,d),(0,a.useEffect)((()=>{d()}),[d]),n}},18820:(e,t,n)=>{n.d(t,{H:()=>i,k:()=>a});const a=18e5,i=6e5},61176:(e,t,n)=>{n.d(t,{$:()=>s});var a=n(85387);const i="/lyrics",s=()=>({isActive:(0,a.zy)().pathname.startsWith(i),routeDestination:i})},40292:(e,t,n)=>{n.d(t,{I:()=>y});var a=n(46710),i=n(3118),s=n(18820),r=n(58336),o=n(63524),c=n(58151),l=n(1681),d=n(77343),u=n(8260);function m(e,t,n){const{startTimeMs:a,words:i}=e,s=n[t+1];return{start:a||0,end:s&&s.startTimeMs?s.startTimeMs:1/0,text:i}}function g(e){return d.Q.fromInt(e).toCSS(u.a.RGB)}var p=n(51496),v=n(64640);const h={hasLyrics:!1},y=(e,t)=>{const n=(0,p.h)(t||void 0,{desiredLabel:"large",desiredSize:600})??t?.[0]?.url??"",d=(0,o.X)(),u=(0,i.NC)(v.Tc,{loadingValue:v.LZ.CONTROL}),y={[v.LZ.CONTROL]:void 0,[v.LZ.SYSTEM_LANGUAGE]:navigator.language,[v.LZ.ALL_LANGUAGES]:"all"}[u],b=["lyrics",{uri:e,image:n,vocalRemoval:d}],{hasLyrics:f,isLoading:x}=(0,r.f)(e),{data:k,isLoading:C,isError:N}=(0,a.I)({queryKey:b,queryFn:async()=>{if(!e||!n)return h;const t=await async function(e,t,n=!1,a){try{const r=await(0,c.S)(e,t,n,a);return{hasLyrics:!0,isTimeSynced:(s=r.lyrics.syncType,"LINE_SYNCED"===s||"SYLLABLE_SYNCED"===s),syncType:r.lyrics.syncType,lyrics:r.lyrics.lines.map(m),colors:(i=r.colors,{text:g(i.text),activeText:g(i.highlightText),background:g(i.background)}),provider:r.lyrics.provider,providerDisplayName:r.lyrics.providerDisplayName,providerLyricsId:r.lyrics.providerLyricsId,hasVocalRemoval:r.hasVocalRemoval??!1,showUpsell:r.lyrics.showUpsell??!1,alternatives:r.lyrics.alternatives}}catch(e){if(e instanceof l.O&&404===e.status)return{hasLyrics:!1};throw e}var i,s}(e,n,d,y);return t},gcTime:s.k,staleTime:s.H,enabled:f}),S=x||C;let j=null;return S||(j=f?k??null:h),{data:j,loading:S,error:N}}},58336:(e,t,n)=>{n.d(t,{f:()=>d});var a=n(46710),i=n(68813),s=n(3118),r=n(72574),o=n(18820),c=n(58151),l=n(90630);const d=e=>{const t=!!e&&(0,r.U_m)(e),n=(0,s.NC)(l.s6w)&&t,{data:d,isLoading:u}=(0,a.I)({queryKey:["useLyricsAvailability",e],queryFn:async()=>!!e&&await(0,c.z)(e),gcTime:o.k,staleTime:o.H,enabled:n,placeholderData:i.rX});return{isLoading:u,hasLyrics:!!n&&(d??!1)}}},95132:(e,t,n)=>{n.d(t,{J:()=>s});var a=n(40292),i=n(34668);const s=()=>{const e=(0,i.o)((e=>e?.item),((e,t)=>e?.uri===t?.uri));return(0,a.I)(e?.uri,e?.images)}},63524:(e,t,n)=>{n.d(t,{X:()=>r});var a=n(3118),i=n(90630),s=n(15058);const r=()=>{const e=(0,s.S)(),{isSupported:t}=e.getCapabilities();return(0,a.NC)(i.OBX,{loadingValue:!1})&&t}},88726:(e,t,n)=>{n.d(t,{r:()=>p});var a=n(30758),i=n(62411),s=n(65652),r=n(32882),o=n(34239),c=n(21832),l=n(14109),d=n(75097),u=n(63291),m=n(90843),g=n(66419);function p(){const e=(0,i.d4)(o.u),t=(0,i.wA)(),{setYlxSidebarState:n}=(0,u.sy)(),{mainLandmarkRef:p,lyricsCinemaRef:v}=(0,s.JT)(),{isActive:h,panelSend:y}=(0,c.AI)(d.Z.NowPlayingView);return{mode:e,setMode:(0,a.useCallback)((e=>{e===m.YU.cinema&&h?(v.current?.classList.add(g.A.lyricsCinemaVisible),p.current?.classList.add(g.A.nonDisplayedArea),n(u.fX.COLLAPSED),y(l.$S.NPV_BUTTON_CLICK)):(v.current?.classList.remove(g.A.lyricsCinemaVisible),p.current?.classList.remove(g.A.nonDisplayedArea),h||y(l.$S.NPV_BUTTON_CLICK)),t((0,r.gh)(e))}),[t,y,h,v,p,n])}}},34239:(e,t,n)=>{n.d(t,{s:()=>i,u:()=>a});const a=e=>e.ui.lyrics.mode,i=e=>e.ui.lyrics.translationLanguage},58151:(e,t,n)=>{n.d(t,{S:()=>r,z:()=>o});var a=n(72574),i=n(49593),s=n(44816);const r=async(e,t,n,r)=>{const o=(0,a.o_h)(e).id,c=i.n.getInstance(),l={format:"json",vocalRemoval:n};r&&(l.clientLanguage=r);return(await c.build().withHost(s.Hj).withPath(`/track/${encodeURIComponent(o)}/image/${encodeURIComponent(t)}`).withQueryParameters(l).withEndpointIdentifier("/track/{trackId}").send()).body},o=async e=>{const t=(0,a.Y8v)((0,a.o_h)(e)?.id);if(!t)return!1;const n=i.n.getInstance(),r=await n.build().withHost(s.XE).withPath(`/track/${encodeURIComponent(t)}`).withEndpointIdentifier("/track/{trackId}").send();return r.body?.has_lyrics||!1}},74911:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(85387),i=n(61176),s=n(39150),r=n(4298);function o({referrer:e,onChange:t}){const n=(0,a.Zp)(),{isActive:o,routeDestination:c}=(0,i.$)(),{setVideoPlayerUIFlag:l}=(0,s.d)(),d=()=>{o||(l(r.n.cinemaLegacy,!1),n(c,{state:{referrer:e}}),t?.(c))},u=()=>{o&&(n(-1),t?.(null))};return{isActive:o,showLyrics:d,hideLyrics:u,toggleLyrics:()=>{o?u():d()}}}},16408:(e,t,n)=>{n.d(t,{P:()=>u,X:()=>d});var a=n(93492),i=n(82414),s=n(56226),r=n(23046),o=n(75784),c=n(24320),l=n(52596);function d(e){return(0,o.v)(e)?a.Ru.get("playback-control.now-playing-label",e.name,e.artists.map((({name:e})=>e)).join(a.Ru.getSeparator())):(0,r.p)(e)?a.Ru.get("playback-control.now-playing-label",e.name,e.show.name):(0,s.d)(e)?a.Ru.get("playback-control.now-playing-label",e.name,e.book.name):(0,i.N)(e)?a.Ru.get("ad-formats.advertisement"):(0,c.v)(e)?void 0:(0,l.d)(e)}function u(e){let t=d(e);return t||(t=a.Ru.get("queue.now-playing")),t}},20714:(e,t,n)=>{n.d(t,{p:()=>o});var a=n(34668),i=n(82414),s=n(56226),r=n(23046);function o(){const e=(0,a.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri));return(0,r.p)(e)||(0,s.d)(e)?"audio"===e.mediaType||"mixed"===e.mediaType:!!(0,i.N)(e)&&e.isPodcastAd}},85271:(e,t,n)=>{n.d(t,{e:()=>v});var a=n(30758),i=n(5119),s=n(56920),r=n(16408),o=n(82414),c=n(56226),l=n(23046),d=n(75784),u=n(24320),m=n(52596),g=n(86070);const p=(0,a.lazy)((()=>n.e(2291).then(n.bind(n,12291)))),v=({context:e,index:t,item:n,isVisible:v,children:h,className:y,referrer:b,onClick:f,adEventReason:x})=>{const k=(0,r.P)(n),C=n.type,N=v?void 0:-1;if((0,d.v)(n)||(0,l.p)(n)||(0,c.d)(n)){const a=(0,s.O)(e,n,t);return a?(0,g.jsx)(i.N,{className:y,referrer:b,"data-testid":"context-link","data-context-item-type":C,style:{border:"none"},to:a.to,search:a.search,"aria-label":k,tabIndex:N,onClick:f,children:h}):(0,g.jsx)(g.Fragment,{children:h})}return(0,o.N)(n)?(0,g.jsx)(a.Suspense,{fallback:(0,g.jsx)(g.Fragment,{children:h}),children:(0,g.jsx)(p,{item:n,"aria-label":k,tabIndex:N,adEventReason:x,children:h})}):(0,u.v)(n)?(0,g.jsx)(g.Fragment,{children:h}):(0,m.d)(n)}},39092:(e,t,n)=>{n.d(t,{j:()=>m});var a=n(30758),i=n(98929),s=n(46710),r=n(13982),o=n(98538),c=n(50210),l=n(21328),d=n(88946);const u={headphoneDevice:null,audioDevice:null,predictedState:null,isOnboarded:!1,currentState:{externalizationEnabled:!1,specificEnabled:!1},contentRestrictions:{specificRestricted:!1,externalizationRestricted:!1,processingCapabilitiesRestricted:!1},toggleTuneHeadphones:null,toggleTuneStudio:null,setFilterState:()=>Promise.resolve()},m=()=>{const e=(0,c.N)(),t=(0,i.jE)(),n=(0,o.l)(),m=(0,a.useMemo)((()=>["puffin-current-device"]),[]),{data:g,isLoading:p,isError:v}=(0,s.I)({queryKey:m,queryFn:async()=>await e.getFilterState(),gcTime:5e3,staleTime:5e3});var h;return h=()=>{t.invalidateQueries({queryKey:m})},(0,d.G)(l.n.UPDATE,h),{deviceFilterState:!n&&g||u,isMaybeHeadphoneDevice:(0,r.lS)(g?.audioDevice),isLoading:p,isError:v}}},98178:(e,t,n)=>{n.d(t,{c:()=>s,t:()=>r});var a=n(72574);const i=e=>({url:e}),s=e=>{const t=[];return e.largeImageUrl?t.push(i(e.largeImageUrl)):e.imageUrl&&t.push(i(e.imageUrl)),{displayName:e.displayName,images:t,username:e.username,uri:(0,a.Qjr)(e.username).toURI()}},r=(e,t,n)=>{const a=[],i=e.sessionMembers.find((({id:t})=>t===e.sessionOwnerId));i&&a.push(i);const r=e.isSessionOwner?void 0:e?.sessionMembers.find((({username:e})=>e===t));r&&(n?.userFirst?a.unshift(r):a.push(r));const o=e.sessionMembers.filter((({username:n,id:a})=>a!==e.sessionOwnerId&&n!==t));return[...a,...o].map(s)}},71627:(e,t,n)=>{n.d(t,{K:()=>b});var a=n(30758),i=n(62411),s=n(74905),r=n(13505),o=n(93492),c=n(69299),l=n(93794),d=n(98178),u=n(60128),m=n(72574),g=n(82362);var p=n(94822);const v="UWuPbrFbZar0lIcBFH31",h="wFkvSGFYuw6rhfwWWYWC";var y=n(86070);const b=()=>{const{currentSession:e}=(0,p.D)(),t=(0,i.d4)((({session:e})=>e.user?.id)),{logJamNameClick:n}=(()=>{const{spec:e,logger:t}=(0,g.r)(u.V,{});return{logJamNameClick:(0,a.useCallback)((()=>{const n=e.jamNameFactory().hitUiNavigate({destination:(0,m.K72)().toURI()});t.logInteraction(n)}),[t,e])}})(),{openQueue:b}=(0,c.R)(),f=(0,a.useCallback)((()=>{n(),b()}),[n,b]);if(!e?.active)return null;const x=e.sessionMembers.find((({id:t})=>t===e.sessionOwnerId)),k=(0,d.t)(e,t,{userFirst:!0});return(0,y.jsxs)("div",{className:v,children:[(0,y.jsx)(l.g,{users:k,dropShadow:!0,size:"small"}),(0,y.jsx)(s.Y,{className:h,onClick:f,semanticColor:"textBase",tabIndex:0,standalone:!0,children:(0,y.jsx)(r.E,{variant:"bodySmallBold",children:o.Ru.get("web-player.social-connect.session-info.title",{host:x?.displayName??""})})})]})}},48455:(e,t,n)=>{n.d(t,{$:()=>i});var a=n(30758);const i=(e,t)=>{const n=(0,a.useRef)(e);(0,a.useEffect)((()=>{n.current=e}),[e]),(0,a.useEffect)((()=>{let e;function a(){e&&clearInterval(e)}if(null!==t)return e=setInterval((function(){n.current(a)}),t),a}),[t])}},56721:(e,t,n)=>{n.d(t,{v:()=>s});var a=n(50210),i=n(20841);const s=()=>{const e=(0,a.N)(),t="1"===(0,i.$)("is-puffin");return e.isAvailable()&&t}},17013:(e,t,n)=>{n.d(t,{f:()=>o});var a=n(30758),i=n(73075),s=n.n(i);const r=new Map;function o(e,t){const n=function(e){const t=r.get(e.toString());if(t)return t;const n=[];return s().bind(e,(()=>n.forEach((e=>e())))),r.set(e.toString(),n),n}(e);(0,a.useEffect)((()=>(n.push(t),()=>{n.splice(n.indexOf(t),1)})),[n,t])}},49559:(e,t,n)=>{n.d(t,{J:()=>i});var a=n(30758);function i(e){const t=(0,a.useRef)(e);return(0,a.useLayoutEffect)((()=>{t.current=e})),(0,a.useCallback)(((...e)=>t.current(...e)),[])}},65282:(e,t,n)=>{n.d(t,{l:()=>c});var a=n(30758),i=n(4827),s=n(63440),r=n(27561);const o={id:"",connectStateId:"",name:"",type:n(73097).bq.COMPUTER,isGroup:!1,isLocal:!0,isActive:!0,isConnecting:!1,isDisabled:!1,volume:0,losslessSupport:{fullySupported:!1,deviceSupported:!1,userEligible:!1},supportsLogout:!1,supportedMediaTypes:null},c=()=>{const e=(0,s.Z)(),[t,n]=(0,a.useState)({currentDevice:o,devices:[]}),c=(0,a.useCallback)((()=>{const t=e.getActiveDevice(),a=e.getDevices();n({currentDevice:t||o,devices:a})}),[e]);return(0,r.W)(i.P.UPDATE,c),(0,a.useEffect)((()=>{c()}),[c]),t}},13946:(e,t,n)=>{n.d(t,{P:()=>a.P});var a=n(6704)},88946:(e,t,n)=>{n.d(t,{G:()=>s});var a=n(30758),i=n(50210);function s(e,t){const n=(0,a.useRef)(t),s=(0,i.N)();n.current=t,(0,a.useEffect)((()=>{const t=s.getFiltersEvents();return t?.addListener(e,(e=>{n.current(e)}))}),[e,s])}},61943:(e,t,n)=>{n.d(t,{c:()=>o});var a=n(30758),i=n(21053),s=n(75788),r=n(49559);function o(e,t){const n=(0,s.d)(),o=(0,r.J)(t),c=(0,i.a)();(0,a.useEffect)((()=>n.getBroadcastingEvents().addListener(e,(e=>{c()&&o(e)}))),[n,o,e,c])}},66419:(e,t,n)=>{n.d(t,{A:()=>a});const a={xs:"(min-width: 0px)",xsOnly:"(min-width: 0px) and (max-width: 767px)",sm:"(min-width: 768px)",smOnly:"(min-width: 768px) and (max-width: 1023px)",md:"(min-width: 1024px)",mdOnly:"(min-width: 1024px) and (max-width: 1279px)",lg:"(min-width: 1280px)",lgOnly:"(min-width: 1280px) and (max-width: 1919px)",xl:"(min-width: 1920px)",lyricsCinemaVisible:"sgQuNaOh5Eu6vnzh3eoh",nonDisplayedArea:"KJNUWtMTBWtQrmsas64b",Container:"F3qS5Fne4ECzEWyFeJ5S",Controls:"dS_1_x4lBrx_vX9AMg6Q",Content:"mC8gFZzy9ZRO5c61MeuO"}}}]);