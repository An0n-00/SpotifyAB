"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[7564],{98104:(t,e,a)=>{a.r(e),a.d(e,{default:()=>At});var n=a(30758),i=a(43752),o=a(93492),r=a(60749),s=a(13505),c=a(555),l=a(97500),u=a.n(l),d=a(45959);const h="jGcEaPyhr1c_janM2uRF",p="OemaZktMXaRcYQ5bcfLZ",m="o5IJsOJEWBEyxtPVVVqQ",g="toPt7VOT_PiDx5Gj3SM2",_="xU4sacBisQneHoQeHMP5",b="srjSlmxMGzXnJBc32BJa",L="lju7xv10a5Y5Z8h8CcKJ",y="jr794VV4i2iUBRhfvS5i",f="KE3gK5ccLz2gL3dhJ4BW",x="pO2rsGFqUdaNhpLrif21",A="Ydxgl4Y23orfVVVI9O2k",j="VhqWrkzIrJrvdyj7ZXMd",N="T3liC_3fbMOTilR4HHKD",v="W_tr6AMQB9Chbc9bCS9w",V="yDdNxgieZmqjgHQCW3UE",C="aikUDGtqRnCX0ZwYHDUW",w="T_HXMW6n5qsbLbPTr1GS",F="tYswKV9PmtTCv62LOPIV",P="GlDNRQ2w0t4h9WBI4GgN",R="BQGSV5BvuAaJ5rmFAXLp",S="ZLbFjRdp1AMXebZH6UWM",B="jhtyHt6d9vbxK6VtCI7a",E="oCaGCB13zdReRutfBS8_",I="MR1n58Qu0kPorQtveOCQ",T="y10vXronmQ6eYMlJrIp3";var k=a(86070);const M=({showOnlineIndicator:t})=>(0,k.jsxs)("div",{className:F,children:[(0,k.jsxs)("div",{className:P,children:[(0,k.jsx)(d.v,{size:"medium"}),t?(0,k.jsx)("div",{className:R}):null]}),(0,k.jsxs)("div",{className:S,children:[(0,k.jsx)("div",{className:u()(B,E)}),(0,k.jsx)("div",{className:B}),(0,k.jsx)("div",{className:B})]})]}),U=()=>(0,k.jsxs)("div",{"data-testid":"buddy-feed-empty-state",className:C,children:[(0,k.jsx)(s.E,{as:"p",className:w,children:o.Ru.get("buddy-feed.let-followers-see-your-listening")}),(0,k.jsx)(M,{showOnlineIndicator:!0}),(0,k.jsx)(M,{showOnlineIndicator:!0}),(0,k.jsx)(M,{}),(0,k.jsx)(s.E,{as:"p",className:w,children:o.Ru.get("buddy-feed.enable-share-listening-activity")}),(0,k.jsx)(r.N_,{to:"/preferences",className:I,children:(0,k.jsx)(c.$,{colorSet:"invertedLight",className:T,children:o.Ru.get("desktop.settings.settings")})})]});var Q=a(68832),G=a(72574),D=a(32284),O=a(12367),H=a(56463),Z=a(96691),W=a(26630),Y=a(39550),J=a(82502),z=a(34855),K=a(5119),X=a(78245),q=a(74584),$=a(89913),tt=a(29888);const et=t=>{const{timestamp:e,isNowPlaying:a}=t;return a?(0,k.jsx)($.Zp,{label:o.Ru.get("time.now"),children:(0,k.jsx)(q.A,{"aria-label":o.Ru.get("time.now"),size:"small"})}):(0,k.jsx)("span",{children:(0,tt.Z)(e)})};var at=a(53575),nt=a(58487),it=a(24395),ot=a(46307),rt=a(99802),st=a(78172);const ct=t=>Date.now()-t<9e5,lt=(t,e)=>{const a=(0,G.o_h)(t)?.type;switch(a){case G.NQG.PLAYLIST:case G.NQG.PLAYLIST_V2:return(0,k.jsx)(W.W,{uri:t});case G.NQG.EPISODE:case G.NQG.SHOW:return(0,k.jsx)(Y.H,{uri:t});case G.NQG.ALBUM:return(0,k.jsx)(H.h,{uri:t,artistUri:e});case G.NQG.ARTIST:return(0,k.jsx)(Z.t,{uri:t});default:return null}},ut=t=>{switch(t){case G.NQG.ALBUM:return st.c.ALBUM;case G.NQG.ARTIST:return st.c.ARTIST;case G.NQG.SHOW:return st.c.SHOW;case G.NQG.EPISODE:return st.c.EPISODE;case G.NQG.PLAYLIST:case G.NQG.PLAYLIST_V2:return st.c.PLAYLIST;default:return}},dt=t=>{const{show:e=!0,spec:a,friend:i}=t,r=(0,n.useMemo)((()=>i.user.imageUrl?[{url:i.user.imageUrl,width:0,height:0}]:[]),[i.user.imageUrl]),c=(0,rt.s)(),l=i.track,d=l.uri,{togglePlay:p,isPlaying:m,isActive:g}=(0,ot.P)({uri:d},{featureIdentifier:"buddy_feed",referrerIdentifier:"buddy_feed"}),C=(0,G.o_h)(l.context.uri),w=C?.type,F=(0,n.useCallback)((()=>{p();const t=a.friendRowFactory().playButtonFactory();g?m?c.logInteraction(t.hitPause({itemToBePaused:d})):c.logInteraction(t.hitResume({itemToBeResumed:d})):c.logInteraction(t.hitPlay({itemToBePlayed:d}))}),[m,d,a,g,p,c]),P=(0,n.useCallback)(((t,e)=>{c.logInteraction(a.friendRowFactory().friendRowLinkFactory({identifier:t}).hitUiNavigate({destination:e}))}),[c,a]),{draggable:R,onDragStart:S}=(0,at.P)({itemUris:[d],dragLabelText:l.name}),{draggable:B,onDragStart:E}=(0,at.P)({itemUris:[l.artist.uri],dragLabelText:l.artist.name}),{draggable:I,onDragStart:T}=(0,at.P)({itemUris:[l.context.uri],dragLabelText:l.context.name});return e?(0,k.jsxs)("div",{className:u()(h),children:[(0,k.jsx)(O.h,{menu:lt(l.context.uri,l.artist.uri),children:(0,k.jsxs)("div",{className:_,children:[(0,k.jsx)(D.e,{label:i.user.name,width:40,userIconSize:"small",images:r,withBadge:ct(i.timestamp)}),(0,k.jsx)(X.x,{className:b,iconClassName:L,isPlaying:m,isLocked:!1,onClick:F,playAriaLabel:m?o.Ru.get("pause"):`${o.Ru.get("play")} ${l.artist.name} ${l.name}`})]})}),(0,k.jsxs)("div",{className:u()(y),children:[(0,k.jsxs)("div",{className:f,children:[(0,k.jsx)(s.E,{as:"p",variant:"bodySmallBold",className:u()(x,"ellipsis-one-line"),children:(0,k.jsx)(it.pZ,{value:"/buddyfeed_user_profile",children:(0,k.jsx)(O.h,{menu:(0,k.jsx)(z.B,{uri:i.user.uri}),children:(0,k.jsx)(K.N,{title:i.user.name,to:i.user.uri,dir:"auto",onClick:()=>P("profile_link",i.user.uri),children:i.user.name})})})}),(0,k.jsx)(s.E,{as:"p",variant:"marginal",className:u()(A),children:(0,k.jsx)(et,{timestamp:i.timestamp,isNowPlaying:ct(i.timestamp)})})]}),(0,k.jsxs)(s.E,{as:"p",variant:"marginal",className:j,children:[(0,k.jsx)(it.pZ,{value:"/buddyfeed_track",children:(0,k.jsx)(O.h,{menu:(0,k.jsx)(J.P,{uri:l.uri,contextUri:l.context.uri,albumUri:l.album.uri,artists:[l.artist]}),children:(0,k.jsx)(K.N,{title:l.name,to:d,className:"ellipsis-one-line",dir:"auto",draggable:R,onDragStart:S,onClick:()=>P("track_link",d),children:l.name})})}),(0,k.jsx)("span",{"aria-hidden":!0,children:" • "}),(0,k.jsx)(it.pZ,{value:"/buddyfeed_artist",children:(0,k.jsx)(O.h,{menu:l.artist?(0,k.jsx)(Z.t,{uri:l.artist.uri}):null,children:(0,k.jsx)(K.N,{title:l.artist.name,to:l.artist.uri,className:"ellipsis-one-line",dir:"auto",draggable:B,onDragStart:E,onClick:()=>P("artist_link",l.artist.uri),children:l.artist.name})})})]}),(0,k.jsx)(s.E,{as:"p",variant:"marginal",className:u()("ellipsis-one-line",v),children:(0,k.jsx)(it.pZ,{value:"/buddyfeed_context",children:(0,k.jsx)(O.h,{menu:lt(l.context.uri,l.artist.uri),children:(0,k.jsxs)(K.N,{title:l.context.name,to:l.context.uri,className:V,draggable:I,onDragStart:T,onClick:()=>P("context_link",l.context.uri),children:[(0,k.jsx)(nt.s,{type:ut(w),iconSize:16,className:N}),(0,k.jsx)("span",{dir:"auto",className:"ellipsis-one-line",children:l.context.name})]})})})})]})]},i.user.uri):null};var ht=a(72630),pt=a(27276),mt=a(94822);function gt({friends:t,spec:e}){const{currentSession:a}=(0,mt.D)(),i=(0,pt.y)(),[o,r]=(0,n.useState)(!0),s=!a?.active&&i&&o&&(0,k.jsx)("li",{className:m,children:(0,k.jsx)(ht.p,{localStorageKey:"dismissStartJamButtonFromFriendFeed",onDismiss:()=>r(!1)})},"start-jam-button");return(0,k.jsx)(Q.ZI,{flipKey:t.map((t=>t.user.uri)).join(""),children:(0,k.jsxs)("ul",{className:p,children:[s,t.map(((t,a)=>(0,k.jsx)(Q.lf,{flipId:t.user.uri,children:(0,k.jsx)("li",{children:(0,k.jsx)(dt,{friend:t,show:a<100,spec:e},t.user.uri)})},t.user.uri)))]})})}var _t=a(73560),bt=a(23857),Lt=a(54106),yt=a(75097),ft=a(42372),xt=a(82362);const At=({friends:t})=>{const e=(0,rt.s)(),{spec:a}=(0,xt.r)(i.W,{}),r=(0,n.useRef)(null);(0,n.useEffect)((()=>{e.logImpression(a.impression())}),[e,a]);const s=0===t.length,c=(0,n.useCallback)((()=>{e.logInteraction(a.closeButtonFactory().hitUiHide())}),[e,a]);return(0,k.jsx)(ft.ql.Provider,{value:"buddy_feed",children:(0,k.jsx)(_t._,{label:o.Ru.get("buddy-feed.friend-activity"),focusTransferId:"BUDDY-FEED",children:(0,k.jsx)("div",{className:g,ref:r,children:(0,k.jsx)(bt.w,{fixedHeader:(0,k.jsx)(Lt.a,{title:o.Ru.get("buddy-feed.friend-activity"),panel:yt.Z.BuddyFeed,onClose:c}),children:s?(0,k.jsx)(U,{}):(0,k.jsx)(gt,{friends:t,spec:a})})})})})}},43752:(t,e,a)=>{a.d(e,{W:()=>s});const n="music",i="2.0.0",o="default",r="12.2.0";function s(t){return new c(t)}class c{constructor(t){this._path=[{name:"desktop-friend-activity"}],t?.parentAbsoluteLocation&&(this._parentAbsoluteLocation=t.parentAbsoluteLocation)}addFriendButtonFactory(){return new c.AddFriendButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}closeButtonFactory(){return new c.CloseButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}friendRowFactory(){return new c.FriendRowEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[i,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}impression(){return{app:n,generatorVersion:r,specificationVersion:i,specificationMode:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}!function(t){t.AddFriendButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"add_friend_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[i,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiReveal(){return{actionName:"ui_reveal",actionVersion:1,app:n,generatorVersion:r,interactionType:"hit",specificationMode:o,specificationVersion:i,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(c||(c={})),function(t){t.CloseButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"close_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[i,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiHide(){return{actionName:"ui_hide",actionVersion:1,app:n,generatorVersion:r,interactionType:"hit",specificationMode:o,specificationVersion:i,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(c||(c={})),function(t){t.FriendRowEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"friend_row"}),e&&(this._parentAbsoluteLocation=e)}playButtonFactory(){return new t.FriendRowEventFactory.PlayButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}friendRowLinkFactory(e){return new t.FriendRowEventFactory.FriendRowLinkEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation,data:e})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[i,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}}}(c||(c={})),function(t){!function(t){t.PlayButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"play_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[i,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitPlay({itemToBePlayed:t}){return{actionParameterNames:["item_to_be_played"],actionParameterValues:[t.toString()],actionName:"play",actionVersion:1,app:n,generatorVersion:r,interactionType:"hit",specificationMode:o,specificationVersion:i,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}hitPause({itemToBePaused:t}){return{actionParameterNames:["item_to_be_paused"],actionParameterValues:[t.toString()],actionName:"pause",actionVersion:1,app:n,generatorVersion:r,interactionType:"hit",specificationMode:o,specificationVersion:i,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}hitResume({itemToBeResumed:t}){return{actionParameterNames:["item_to_be_resumed"],actionParameterValues:[t.toString()],actionName:"resume",actionVersion:1,app:n,generatorVersion:r,interactionType:"hit",specificationMode:o,specificationVersion:i,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(t.FriendRowEventFactory||(t.FriendRowEventFactory={}))}(c||(c={})),function(t){!function(t){t.FriendRowLinkEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({...a,name:"friend_row_link"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[i,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiNavigate({destination:t}){return{actionParameterNames:["destination"],actionParameterValues:[t.toString()],actionName:"ui_navigate",actionVersion:1,app:n,generatorVersion:r,interactionType:"hit",specificationMode:o,specificationVersion:i,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(t.FriendRowEventFactory||(t.FriendRowEventFactory={}))}(c||(c={}))}}]);